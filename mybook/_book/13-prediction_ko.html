<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; 예측 – 데이터로 이야기하기</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14-causality_from_obs_ko.html" rel="next">
<link href="./13-ijaglm_ko.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b22ef3f334bfc3d7f06e555e13679c65.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-ijalm_ko.html">모델링</a></li><li class="breadcrumb-item"><a href="./13-prediction_ko.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">예측</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="검색" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">데이터로 이야기하기</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/RohanAlexander/telling_stories/" title="소스 코드" class="quarto-navigation-tool px-1" aria-label="소스 코드"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서문</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-errata_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">오류 및 업데이트</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">기초</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">데이터로 이야기하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-drinking_from_a_fire_hose_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">소방 호스에서 마시기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-workflow_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">재현 가능한 워크플로우</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">소통</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-writing_research_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">연구 작성</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-graphs_tables_maps_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">그래프, 표, 지도</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">획득</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-farm_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">측정, 인구 조사, 표본 추출</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-gather_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">API, 스크래핑, 파싱</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-hunt_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">실험 및 설문 조사</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">준비</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-clean_and_prepare_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">정리, 준비 및 테스트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-store_and_share_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">저장 및 공유</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-eda_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">모델링</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-ijalm_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 모델</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-ijaglm_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">일반화 선형 모델</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-prediction_ko.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">예측</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">적용</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-causality_from_obs_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">관찰 데이터에서 인과 관계</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-mrp_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">사후 층화 다단계 회귀</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-text_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">데이터로서의 텍스트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-concluding_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">17-concluding_ko.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">부록</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-r_essentials_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R 필수 사항</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-python_essentials_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Python 필수 사항</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-sql_essentials_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">SQL 필수</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-datasets_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">데이터셋</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-rmarkdown_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">R 마크다운</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-papers_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">논문</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-deploy_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">생산</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98-cocktails_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">칵테일</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#서론" id="toc-서론" class="nav-link active" data-scroll-target="#서론"><span class="header-section-number">14.1</span> 서론</a></li>
  <li><a href="#tidymodels를-사용한-예측" id="toc-tidymodels를-사용한-예측" class="nav-link" data-scroll-target="#tidymodels를-사용한-예측"><span class="header-section-number">14.2</span> <code>tidymodels</code>를 사용한 예측</a>
  <ul class="collapse">
  <li><a href="#선형-모델" id="toc-선형-모델" class="nav-link" data-scroll-target="#선형-모델"><span class="header-section-number">14.2.1</span> 선형 모델</a></li>
  <li><a href="#로지스틱-회귀" id="toc-로지스틱-회귀" class="nav-link" data-scroll-target="#로지스틱-회귀"><span class="header-section-number">14.2.2</span> 로지스틱 회귀</a></li>
  <li><a href="#포아송-회귀" id="toc-포아송-회귀" class="nav-link" data-scroll-target="#포아송-회귀"><span class="header-section-number">14.2.3</span> 포아송 회귀</a></li>
  </ul></li>
  <li><a href="#라쏘-회귀" id="toc-라쏘-회귀" class="nav-link" data-scroll-target="#라쏘-회귀"><span class="header-section-number">14.3</span> 라쏘 회귀</a></li>
  <li><a href="#python을-사용한-예측" id="toc-python을-사용한-예측" class="nav-link" data-scroll-target="#python을-사용한-예측"><span class="header-section-number">14.4</span> Python을 사용한 예측</a>
  <ul class="collapse">
  <li><a href="#설정" id="toc-설정" class="nav-link" data-scroll-target="#설정"><span class="header-section-number">14.4.1</span> 설정</a></li>
  <li><a href="#데이터" id="toc-데이터" class="nav-link" data-scroll-target="#데이터"><span class="header-section-number">14.4.2</span> 데이터</a></li>
  <li><a href="#모델" id="toc-모델" class="nav-link" data-scroll-target="#모델"><span class="header-section-number">14.4.3</span> 모델</a></li>
  </ul></li>
  <li><a href="#연습-문제" id="toc-연습-문제" class="nav-link" data-scroll-target="#연습-문제"><span class="header-section-number">14.5</span> 연습 문제</a>
  <ul class="collapse">
  <li><a href="#연습" id="toc-연습" class="nav-link" data-scroll-target="#연습">연습</a></li>
  <li><a href="#퀴즈" id="toc-퀴즈" class="nav-link" data-scroll-target="#퀴즈">퀴즈</a></li>
  <li><a href="#수업-활동" id="toc-수업-활동" class="nav-link" data-scroll-target="#수업-활동">수업 활동</a></li>
  <li><a href="#과제" id="toc-과제" class="nav-link" data-scroll-target="#과제">과제</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/RohanAlexander/telling_stories/edit/main/13-prediction_ko.qmd" class="toc-action"><i class="bi bi-github"></i>편집</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-ijalm_ko.html">모델링</a></li><li class="breadcrumb-item"><a href="./13-prediction_ko.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">예측</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-predictingpythons" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">예측</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>선수 지식</strong></p>
<ul>
<li><em>R을 사용한 통계 학습 소개</em>, <span class="citation" data-cites="islr">(<a href="#ref-islr" role="doc-biblioref">James 기타 [2013년] 2021</a>)</span>
<ul>
<li>6장 “선형 모델 선택 및 정규화”에 집중하세요. 이는 릿지 및 라쏘 회귀에 대한 개요를 제공합니다.</li>
</ul></li>
<li><em>데이터 분석을 위한 Python</em>, <span class="citation" data-cites="pythonfordataanalysis">(<a href="#ref-pythonfordataanalysis" role="doc-biblioref">McKinney [2011년] 2022</a>)</span>
<ul>
<li>Python에서 데이터 분석의 작업 예시를 제공하는 13장에 집중하세요.</li>
</ul></li>
<li><em>R을 사용한 NFL 분석 소개</em>, <span class="citation" data-cites="congelio2024">(<a href="#ref-congelio2024" role="doc-biblioref">Congelio 2024</a>)</span>
<ul>
<li>3장 “<code>nflverse</code> 패키지 제품군을 사용한 NFL 분석” 및 5장 “NFL 데이터를 사용한 고급 모델 생성”에 집중하세요.</li>
</ul></li>
</ul>
<p><strong>핵심 개념 및 기술</strong></p>
<p><strong>소프트웨어 및 패키지</strong></p>
<ul>
<li><code>arrow</code> <span class="citation" data-cites="arrow">(<a href="#ref-arrow" role="doc-biblioref">Richardson 기타 2023</a>)</span></li>
<li><code>nflverse</code> <span class="citation" data-cites="nflverse">(<a href="#ref-nflverse" role="doc-biblioref">Carl 기타 2023</a>)</span></li>
<li><code>poissonreg</code> <span class="citation" data-cites="poissonreg">(<a href="#ref-poissonreg" role="doc-biblioref">Kuhn 와/과 Frick 2022</a>)</span></li>
<li><code>tidymodels</code> <span class="citation" data-cites="citeTidymodels">(<a href="#ref-citeTidymodels" role="doc-biblioref">Kuhn 와/과 Wickham 2020</a>)</span>
<ul>
<li><code>parsnip</code> <span class="citation" data-cites="parsnip">(<a href="#ref-parsnip" role="doc-biblioref">Kuhn 와/과 Vaughan 2022</a>)</span></li>
<li><code>recipes</code> <span class="citation" data-cites="recipes">(<a href="#ref-recipes" role="doc-biblioref">Kuhn 와/과 Wickham 2022</a>)</span></li>
<li><code>rsample</code> <span class="citation" data-cites="rsample">(<a href="#ref-rsample" role="doc-biblioref">Frick 기타 2022</a>)</span></li>
<li><code>tune</code> <span class="citation" data-cites="tune">(<a href="#ref-tune" role="doc-biblioref">Kuhn 2022</a>)</span></li>
<li><code>yarkdstick</code> <span class="citation" data-cites="yardstick">(<a href="#ref-yardstick" role="doc-biblioref">Kuhn, Vaughan, 와/과 Hvitfeldt 2022</a>)</span></li>
</ul></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">Wickham 기타 2019</a>)</span></li>
<li><code>tinytable</code> <span class="citation" data-cites="tinytable">(<a href="#ref-tinytable" role="doc-biblioref">Arel-Bundock 2024</a>)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(nflverse)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poissonreg)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytable)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="서론" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="서론"><span class="header-section-number">14.1</span> 서론</h2>
<p><a href="#sec-its-just-a-linear-model에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-linear-model에서</span></a> 논의했듯이, 모델은 추론 또는 예측에 중점을 두는 경향이 있습니다. 일반적으로 초점에 따라 다른 문화가 있습니다. 이에 대한 한 가지 이유는 <a href="#sec-causality-from-observational-data에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-causality-from-observational-data에서</span></a> 소개될 인과 관계에 대한 다른 강조 때문입니다. 여기서 매우 일반적으로 말하자면, 추론에서는 인과 관계에 대해 매우 우려하지만, 예측에서는 덜 우려합니다. 이는 모델이 예상했던 것과 조건이 상당히 다를 때 예측의 품질이 저하된다는 것을 의미합니다. 그러나 조건이 충분히 다른지 어떻게 알 수 있을까요?</p>
<p>이러한 문화적 차이에 대한 또 다른 이유는 데이터 과학, 특히 기계 학습의 부상이 컴퓨터 과학 또는 공학 배경을 가진 사람들이 Python으로 모델을 개발하는 데 크게 기여했기 때문입니다. 이는 추론의 대부분이 통계학에서 나왔기 때문에 추가적인 어휘 차이가 있다는 것을 의미합니다. 다시 말하지만, 이 모든 것은 매우 일반적으로 말하는 것입니다.</p>
<p>이 장에서는 <code>tidymodels</code>의 R 접근 방식을 사용하여 예측에 중점을 둡니다. 그런 다음 회색 영역 중 하나인 라쏘 회귀를 소개합니다. 이는 통계학자들이 개발했지만 주로 예측에 사용됩니다. 마지막으로, 이 모든 것을 Python으로 소개합니다.</p>
</section>
<section id="tidymodels를-사용한-예측" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="tidymodels를-사용한-예측"><span class="header-section-number">14.2</span> <code>tidymodels</code>를 사용한 예측</h2>
<section id="선형-모델" class="level3" data-number="14.2.1">
<h3 data-number="14.2.1" class="anchored" data-anchor-id="선형-모델"><span class="header-section-number">14.2.1</span> 선형 모델</h3>
<p>예측에 초점을 맞출 때, 종종 많은 모델을 적합하고 싶을 것입니다. 이를 수행하는 한 가지 방법은 코드를 여러 번 복사하여 붙여넣는 것입니다. 이것은 괜찮고, 대부분의 사람들이 시작하는 방법이지만, 찾기 어려운 오류를 만들 가능성이 높습니다. 더 나은 접근 방식은 다음과 같습니다.</p>
<ol type="1">
<li>더 쉽게 확장 가능;</li>
<li>과적합에 대해 신중하게 생각할 수 있도록; 그리고</li>
<li>모델 평가 추가.</li>
</ol>
<p><code>tidymodels</code><span class="citation" data-cites="citeTidymodels">(<a href="#ref-citeTidymodels" role="doc-biblioref">Kuhn 와/과 Wickham 2020</a>)</span>의 사용은 다양한 모델을 쉽게 적합할 수 있는 일관된 문법을 제공하여 이러한 기준을 충족합니다. <code>tidyverse</code>와 마찬가지로, 패키지 모음입니다.</p>
<p>설명을 위해, 시뮬레이션된 달리기 데이터에 대해 다음 모델을 추정하고자 합니다.</p>
<p><span class="math display">\[
\begin{aligned}
y_i | \mu_i &amp;\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \beta_0 +\beta_1x_i
\end{aligned}
\]</span></p>
<p>여기서 <span class="math inline">\(y_i\)</span>는 어떤 개인 <span class="math inline">\(i\)</span>의 마라톤 시간을 나타내고 <span class="math inline">\(x_i\)</span>는 그들의 5킬로미터 시간을 나타냅니다. 여기서 우리는 어떤 개인 <span class="math inline">\(i\)</span>의 마라톤 시간이 평균 <span class="math inline">\(\mu\)</span>와 표준 편차 <span class="math inline">\(\sigma\)</span>를 가진 정규 분포를 따르며, 평균은 두 매개변수 <span class="math inline">\(\beta_0\)</span>와 <span class="math inline">\(\beta_1\)</span> 및 그들의 5킬로미터 시간에 따라 달라진다고 말합니다. 여기서 “~”는 “~로 분포된다”는 의미입니다. 사용되는 분포에 대해 더 명시적으로 하기 위해 이전과 약간 다른 표기법을 사용하지만, 이 모델은 <span class="math inline">\(y_i=\beta_0+\beta_1 x_i + \epsilon_i\)</span>와 동일하며, 여기서 <span class="math inline">\(\epsilon\)</span>은 정규 분포를 따릅니다.</p>
<p>예측에 초점을 맞추고 있으므로, 데이터 과적합에 대해 우려합니다. 이는 다른 데이터셋에 대한 주장을 할 수 있는 능력을 제한할 것입니다. 이를 부분적으로 해결하는 한 가지 방법은 <code>initial_split()</code>을 사용하여 데이터셋을 두 개로 나누는 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sim_run_data <span class="ot">&lt;-</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_parquet</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"outputs/data/running_data.parquet"</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>sim_run_data_split <span class="ot">&lt;-</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sim_run_data,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fl">0.80</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>sim_run_data_split</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Training/Testing/Total&gt;
&lt;160/40/200&gt;</code></pre>
</div>
</div>
<p>데이터를 분할한 후, <code>training()</code>과 <code>testing()</code>을 사용하여 훈련 및 테스트 데이터셋을 생성합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sim_run_data_train <span class="ot">&lt;-</span> <span class="fu">training</span>(sim_run_data_split)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sim_run_data_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(sim_run_data_split)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터셋의 80%를 훈련 데이터셋에 배치했습니다. 이를 사용하여 모델의 매개변수를 추정할 것입니다. 나머지 20%는 남겨두고, 이를 사용하여 모델을 평가할 것입니다. 왜 이렇게 할까요? 우리의 관심사는 모델링의 모든 측면을 괴롭히는 편향-분산 트레이드오프입니다. 우리는 결과가 우리가 가진 데이터셋에 너무 특수하여 다른 데이터셋에 적용할 수 없을까 봐 우려합니다. 극단적인 예를 들자면, 10개의 관측치를 가진 데이터셋을 생각해 보십시오. 우리는 그 관측치를 완벽하게 맞추는 모델을 만들 수 있습니다. 그러나 그 모델을 다른 데이터셋에 적용하면, 동일한 기본 프로세스에 의해 생성된 데이터셋이라 할지라도 정확하지 않을 것입니다.</p>
<p>이러한 우려를 해결하는 한 가지 방법은 데이터를 이런 식으로 분할하는 것입니다. 우리는 훈련 데이터를 사용하여 계수 추정치를 얻고, 테스트 데이터를 사용하여 모델을 평가합니다. 훈련 데이터에 너무 밀접하게 일치하는 모델은 테스트 데이터에서 잘 작동하지 않을 것입니다. 왜냐하면 훈련 데이터에 너무 특수하기 때문입니다. 이러한 테스트-훈련 분할을 사용하면 적절한 모델을 구축할 기회를 얻을 수 있습니다.</p>
<p>이러한 분리를 적절하게 수행하는 것은 처음 생각하는 것보다 더 어렵습니다. 테스트 데이터셋의 측면이 훈련 데이터셋에 존재하여 부적절하게 앞으로 일어날 일을 미리 알려주는 상황을 피하고 싶습니다. 이를 데이터 누출이라고 합니다. 그러나 전체 데이터셋을 포함할 가능성이 있는 데이터 정리 및 준비를 고려하면, 각 데이터셋의 일부 기능이 서로 영향을 미칠 수 있습니다. <span class="citation" data-cites="kapoornarayanan2022는">(<a href="#ref-kapoornarayanan2022는" role="doc-biblioref"><strong>kapoornarayanan2022는?</strong></a>)</span> 많은 연구를 무효화할 수 있는 기계 학습 응용 프로그램에서 광범위한 데이터 누출을 발견했습니다.</p>
<p><code>tidymodels</code>를 사용하려면 먼저 <code>linear_reg()</code>로 선형 회귀에 관심이 있음을 지정합니다. 그런 다음 <code>set_engine()</code>로 선형 회귀 유형(이 경우 다중 선형 회귀)을 지정합니다. 마지막으로 <code>fit()</code>으로 모델을 지정합니다. 이것은 위에서 자세히 설명한 기본 R 접근 방식보다 훨씬 더 많은 인프라를 필요로 하지만, 이 접근 방식의 장점은 많은 모델을 적합하는 데 사용할 수 있다는 것입니다. 말하자면, 모델 공장을 만든 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sim_run_data_first_model_tidymodels <span class="ot">&lt;-</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">"lm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    marathon_time <span class="sc">~</span> five_km_time <span class="sc">+</span> was_raining,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sim_run_data_train</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>추정된 계수는 <a href="#tbl-modelsummarybayesbetter의" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarybayesbetter의</span></a> 첫 번째 열에 요약되어 있습니다. 예를 들어, 데이터셋에서 5킬로미터 달리기 시간이 1분 더 길면 마라톤 시간이 약 8분 더 길어진다는 것을 발견합니다.</p>
</section>
<section id="로지스틱-회귀" class="level3" data-number="14.2.2">
<h3 data-number="14.2.2" class="anchored" data-anchor-id="로지스틱-회귀"><span class="header-section-number">14.2.2</span> 로지스틱 회귀</h3>
<p>로지스틱 회귀 문제에도 <code>tidymodels</code>를 사용할 수 있습니다. 이를 위해 먼저 종속 변수의 클래스를 요인으로 변경해야 합니다. 이는 분류 모델에 필요하기 때문입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>week_or_weekday <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_parquet</span>(<span class="at">file =</span> <span class="st">"outputs/data/week_or_weekday.parquet"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>week_or_weekday <span class="ot">&lt;-</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  week_or_weekday <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_weekday =</span> <span class="fu">as_factor</span>(is_weekday))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>week_or_weekday_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(week_or_weekday, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>week_or_weekday_train <span class="ot">&lt;-</span> <span class="fu">training</span>(week_or_weekday_split)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>week_or_weekday_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(week_or_weekday_split)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>week_or_weekday_tidymodels <span class="ot">&lt;-</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>(<span class="at">mode =</span> <span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    is_weekday <span class="sc">~</span> number_of_cars,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> week_or_weekday_train</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이전과 마찬가지로, 추정치와 비교하여 실제 결과를 그래프로 그릴 수 있습니다. 그러나 이의 좋은 점 중 하나는 테스트 데이터셋을 사용하여 모델의 예측 능력을 더 철저히 평가할 수 있다는 것입니다. 예를 들어, 혼동 행렬을 통해 각 예측의 개수를 실제 값과 비교하여 지정할 수 있습니다. 모델이 보류된 데이터셋에서 잘 작동한다는 것을 발견했습니다. 모델이 주중이라고 예측한 관측치는 90개였고, 실제로 주중이었습니다. 모델이 주말이라고 예측한 관측치는 95개였고, 실제로 주말이었습니다. 15개의 관측치에서 오류가 있었고, 이들은 주중이라고 예측했지만 주말이었던 7개와 그 반대였던 8개로 나뉘었습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>week_or_weekday_tidymodels <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> week_or_weekday_test) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(week_or_weekday_test) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> is_weekday, <span class="at">estimate =</span> .pred_class)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction  0  1
         0 90  8
         1  7 95</code></pre>
</div>
</div>
<section id="미국-정치적-지지" class="level4" data-number="14.2.2.1">
<h4 data-number="14.2.2.1" class="anchored" data-anchor-id="미국-정치적-지지"><span class="header-section-number">14.2.2.1</span> 미국 정치적 지지</h4>
<p>한 가지 접근 방식은 <code>tidymodels</code>를 사용하여 이전과 동일한 방식으로 예측 중심 로지스틱 회귀 모델을 구축하는 것입니다. 즉, 검증 세트 접근 방식입니다<span class="citation" data-cites="islr">(<a href="#ref-islr" role="doc-biblioref">James 기타 [2013년] 2021</a>, p.&nbsp;176)</span>. 이 경우 확률은 바이든에게 투표할 확률이 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ces2020 <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_parquet</span>(<span class="at">file =</span> <span class="st">"outputs/data/ces2020.parquet"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ces2020_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ces2020, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>ces2020_train <span class="ot">&lt;-</span> <span class="fu">training</span>(ces2020_split)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ces2020_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(ces2020_split)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>ces_tidymodels <span class="ot">&lt;-</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>(<span class="at">mode =</span> <span class="st">"classification"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    voted_for <span class="sc">~</span> gender <span class="sc">+</span> education,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ces2020_train</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>ces_tidymodels</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:  stats::glm(formula = voted_for ~ gender + education, family = stats::binomial, 
    data = data)

Coefficients:
                  (Intercept)                     genderMale  
                       0.2157                        -0.4697  
educationHigh school graduate          educationSome college  
                      -0.1857                         0.3502  
              education2-year                education4-year  
                       0.2311                         0.6700  
           educationPost-grad  
                       0.9898  

Degrees of Freedom: 34842 Total (i.e. Null);  34836 Residual
Null Deviance:      47000 
Residual Deviance: 45430    AIC: 45440</code></pre>
</div>
</div>
<p>그런 다음 테스트 세트에서 평가합니다. 모델이 트럼프 지지자를 식별하는 데 어려움을 겪는 것으로 보입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ces_tidymodels <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> ces2020_test) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(ces2020_test) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> voted_for, <span class="at">estimate =</span> .pred_class)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction Trump Biden
     Trump   656   519
     Biden  2834  4702</code></pre>
</div>
</div>
<p><code>tidymodels</code>를 소개할 때, 훈련 및 테스트 세트를 무작위로 구성하는 것의 중요성에 대해 논의했습니다. 우리는 훈련 데이터셋을 사용하여 매개변수를 추정하고, 테스트 세트에서 모델을 평가합니다. 무작위성의 변덕에 따라야 하는 이유와 데이터를 최대한 활용하고 있는지 묻는 것은 당연합니다. 예를 들어, 좋은 모델이 테스트 세트에 무작위로 포함되어 제대로 평가되지 않으면 어떻게 될까요? 또한, 테스트 세트가 크지 않으면 어떻게 될까요?</p>
<p>이를 해결하는 데 도움이 되는 일반적으로 사용되는 리샘플링 방법 중 하나는 <span class="math inline">\(k\)</span>-겹 교차 검증입니다. 이 접근 방식에서는 데이터셋에서 <span class="math inline">\(k\)</span>개의 다른 샘플 또는 “폴드”를 대체 없이 생성합니다. 그런 다음 모델을 처음 <span class="math inline">\(k-1\)</span>개의 폴드에 적합하고, 마지막 폴드에서 평가합니다. 모든 관측치가 <span class="math inline">\(k-1\)</span>번 훈련에 사용되고 한 번 테스트에 사용되도록 각 폴드에 대해 <span class="math inline">\(k\)</span>번 이 작업을 수행합니다. <span class="math inline">\(k\)</span>-겹 교차 검증 추정치는 평균 제곱 오차의 평균입니다<span class="citation" data-cites="islr">(<a href="#ref-islr" role="doc-biblioref">James 기타 [2013년] 2021</a>, p.&nbsp;181)</span>. 예를 들어, <code>tidymodels</code>의 <code>vfold_cv()</code>를 사용하여 10개의 폴드를 생성할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ces2020_10_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ces2020, <span class="at">v =</span> <span class="dv">10</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>그런 다음 <code>fit_resamples()</code>를 사용하여 폴드의 다른 조합에 걸쳐 모델을 적합할 수 있습니다. 이 경우 모델은 10번 적합됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ces2020_cross_validation <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">object =</span> <span class="fu">logistic_reg</span>(<span class="at">mode =</span> <span class="st">"classification"</span>) <span class="sc">|&gt;</span> <span class="fu">set_engine</span>(<span class="st">"glm"</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">preprocessor =</span> <span class="fu">recipe</span>(voted_for <span class="sc">~</span> gender <span class="sc">+</span> education,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> ces2020),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ces2020_10_folds,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, sens),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>모델의 성능을 이해하는 데 관심이 있을 수 있으며, <code>collect_metrics()</code>를 사용하여 폴드 전체에서 집계할 수 있습니다(<a href="#tbl-metricsvoters-1" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-metricsvoters-1</span></a>). 이러한 유형의 세부 정보는 일반적으로 논문의 본문에서 간략하게 언급되지만, 부록에 자세히 포함됩니다. 폴드 전체에서 모델의 평균 정확도는 0.61이고, 평균 민감도는 0.19이며, 평균 특이도는 0.90입니다.</p>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(ces2020_cross_validation) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.metric, mean) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">style_tt</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">align =</span> <span class="st">"lr"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_tt</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">num_mark_big =</span> <span class="st">","</span>, <span class="at">num_fmt =</span> <span class="st">"decimal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"지표"</span>, <span class="st">"평균"</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_mat_resampled</span>(ces2020_cross_validation) <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> Freq <span class="sc">/</span> <span class="fu">sum</span>(Freq)) <span class="sc">|&gt;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">style_tt</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">align =</span> <span class="st">"llrr"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_tt</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">num_mark_big =</span> <span class="st">","</span>, <span class="at">num_fmt =</span> <span class="st">"decimal"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-metricsvoters" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-metricsvoters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
표&nbsp;14.1: 유권자 선호도를 예측하기 위한 로지스틱 회귀의 10겹 교차 검증에 대한 평균 지표
</figcaption>
<div aria-describedby="tbl-metricsvoters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-metricsvoters" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="tbl-metricsvoters-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-metricsvoters-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 주요 성능 지표
</figcaption>
<div aria-describedby="tbl-metricsvoters-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_emd0ox4fx7d4a114nwh5(i, j, css_id) {
          var table = document.getElementById("tinytable_emd0ox4fx7d4a114nwh5");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_emd0ox4fx7d4a114nwh5');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_emd0ox4fx7d4a114nwh5(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_emd0ox4fx7d4a114nwh5");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '2', j: 1 },  ], css_id: 'tinytable_css_xx2hqrlqhlk9prgsjf4g',}, 
          { positions: [ { i: '1', j: 1 },  ], css_id: 'tinytable_css_7bhjrt2bmmnzzedgu917',}, 
          { positions: [ { i: '0', j: 1 },  ], css_id: 'tinytable_css_hf5oph1di3yxb6uf3leg',}, 
          { positions: [ { i: '2', j: 0 },  ], css_id: 'tinytable_css_q8g4370zmf2ncxm8r37p',}, 
          { positions: [ { i: '1', j: 0 },  ], css_id: 'tinytable_css_kf7kaemoen8qexxxa9yz',}, 
          { positions: [ { i: '0', j: 0 },  ], css_id: 'tinytable_css_0j4z9m4ltwowhdaorv4c',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_emd0ox4fx7d4a114nwh5(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_xx2hqrlqhlk9prgsjf4g, .table th.tinytable_css_xx2hqrlqhlk9prgsjf4g { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_7bhjrt2bmmnzzedgu917, .table th.tinytable_css_7bhjrt2bmmnzzedgu917 { text-align: right; }
      .table td.tinytable_css_hf5oph1di3yxb6uf3leg, .table th.tinytable_css_hf5oph1di3yxb6uf3leg { text-align: right; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_q8g4370zmf2ncxm8r37p, .table th.tinytable_css_q8g4370zmf2ncxm8r37p { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_kf7kaemoen8qexxxa9yz, .table th.tinytable_css_kf7kaemoen8qexxxa9yz { text-align: left; }
      .table td.tinytable_css_0j4z9m4ltwowhdaorv4c, .table th.tinytable_css_0j4z9m4ltwowhdaorv4c { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_emd0ox4fx7d4a114nwh5" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">지표</th>
                <th scope="col" data-row="0" data-col="1">평균</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">accuracy</td>
                  <td data-row="1" data-col="1">0.61</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">sens</td>
                  <td data-row="2" data-col="1">0.19</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-metricsvoters" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="tbl-metricsvoters-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-metricsvoters-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 혼동 행렬
</figcaption>
<div aria-describedby="tbl-metricsvoters-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_qjsj11lp5d3rwhcvrlt5(i, j, css_id) {
          var table = document.getElementById("tinytable_qjsj11lp5d3rwhcvrlt5");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_qjsj11lp5d3rwhcvrlt5');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_qjsj11lp5d3rwhcvrlt5(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_qjsj11lp5d3rwhcvrlt5");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '4', j: 2 }, { i: '4', j: 3 },  ], css_id: 'tinytable_css_l66xxvepir75bggd4k3m',}, 
          { positions: [ { i: '2', j: 2 }, { i: '3', j: 2 }, { i: '3', j: 3 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '2', j: 3 },  ], css_id: 'tinytable_css_2db9jzfiqweplpchall8',}, 
          { positions: [ { i: '0', j: 2 }, { i: '0', j: 3 },  ], css_id: 'tinytable_css_ucmvmnqtb1z70d07wege',}, 
          { positions: [ { i: '4', j: 0 }, { i: '4', j: 1 },  ], css_id: 'tinytable_css_rduefr8b7ugog7qrlk6h',}, 
          { positions: [ { i: '2', j: 0 }, { i: '3', j: 0 }, { i: '3', j: 1 }, { i: '1', j: 0 }, { i: '1', j: 1 }, { i: '2', j: 1 },  ], css_id: 'tinytable_css_9fj2a6gtfjtf68l2zvoy',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_hdpxftipd1v8ab7ahvyy',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_qjsj11lp5d3rwhcvrlt5(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_l66xxvepir75bggd4k3m, .table th.tinytable_css_l66xxvepir75bggd4k3m { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_2db9jzfiqweplpchall8, .table th.tinytable_css_2db9jzfiqweplpchall8 { text-align: right; }
      .table td.tinytable_css_ucmvmnqtb1z70d07wege, .table th.tinytable_css_ucmvmnqtb1z70d07wege { text-align: right; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_rduefr8b7ugog7qrlk6h, .table th.tinytable_css_rduefr8b7ugog7qrlk6h { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_9fj2a6gtfjtf68l2zvoy, .table th.tinytable_css_9fj2a6gtfjtf68l2zvoy { text-align: left; }
      .table td.tinytable_css_hdpxftipd1v8ab7ahvyy, .table th.tinytable_css_hdpxftipd1v8ab7ahvyy { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_qjsj11lp5d3rwhcvrlt5" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">Prediction</th>
                <th scope="col" data-row="0" data-col="1">Truth</th>
                <th scope="col" data-row="0" data-col="2">Freq</th>
                <th scope="col" data-row="0" data-col="3">Proportion</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">Trump</td>
                  <td data-row="1" data-col="1">Trump</td>
                  <td data-row="1" data-col="2">327.5</td>
                  <td data-row="1" data-col="3">0.08</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">Trump</td>
                  <td data-row="2" data-col="1">Biden</td>
                  <td data-row="2" data-col="2">267.7</td>
                  <td data-row="2" data-col="3">0.06</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">Biden</td>
                  <td data-row="3" data-col="1">Trump</td>
                  <td data-row="3" data-col="2">1,428.3</td>
                  <td data-row="3" data-col="3">0.33</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">Biden</td>
                  <td data-row="4" data-col="1">Biden</td>
                  <td data-row="4" data-col="2">2,331.9</td>
                  <td data-row="4" data-col="3">0.54</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>이것은 무엇을 의미합니까? 정확도는 올바르게 분류된 관측치의 비율입니다. 0.61이라는 결과는 모델이 동전 던지기보다 잘 작동하지만, 그 이상은 아니라는 것을 시사합니다. 민감도는 참으로 식별된 참 관측치의 비율입니다<span class="citation" data-cites="islr">(<a href="#ref-islr" role="doc-biblioref">James 기타 [2013년] 2021</a>, p.&nbsp;145)</span>. 이 경우 모델이 응답자가 트럼프에게 투표했다고 예측했고, 실제로 그랬다는 것을 의미합니다. 특이도는 거짓으로 식별된 거짓 관측치의 비율입니다<span class="citation" data-cites="islr">(<a href="#ref-islr" role="doc-biblioref">James 기타 [2013년] 2021</a>, p.&nbsp;145)</span>. 이 경우 바이든에게 투표한 유권자 중 바이든에게 투표할 것으로 예측된 유권자의 비율입니다. 이는 모델이 트럼프 지지자를 식별하는 데 어려움을 겪고 있다는 우리의 초기 생각을 확인시켜 줍니다.</p>
<p>혼동 행렬을 보면 더 자세히 알 수 있습니다(<a href="#tbl-metricsvoters-2" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-metricsvoters-2</span></a>). 교차 검증과 같은 리샘플링 접근 방식과 함께 사용될 때, 혼동 행렬은 각 폴드에 대해 계산된 다음 평균화됩니다. 모델은 2020년 선거가 얼마나 근접했는지에 대한 우리의 지식에서 예상할 수 있는 것보다 훨씬 더 많이 바이든을 예측하고 있습니다. 이는 모델이 더 나은 작업을 수행하기 위해 추가 변수가 필요할 수 있음을 시사합니다.</p>
<p>마지막으로, 개별 수준 결과에 관심이 있는 경우 <code>collect_predictions()</code>를 사용하여 데이터셋에 추가할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ces2020_with_predictions <span class="ot">&lt;-</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    ces2020,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">collect_predictions</span>(ces2020_cross_validation) <span class="sc">|&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(.row) <span class="sc">|&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(.pred_class)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>예를 들어, 모델이 고등학교를 졸업하지 않았거나, 고등학교를 졸업했거나, 2년제 대학을 졸업한 남성을 제외한 모든 개인에 대해 바이든 지지를 예측하고 있음을 알 수 있습니다(<a href="#tbl-omgthismodelishorriblelol" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-omgthismodelishorriblelol</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ces2020_with_predictions <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender, education, voted_for) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(.pred_class) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">style_tt</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">align =</span> <span class="st">"llllr"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">format_tt</span>(<span class="at">digits =</span> <span class="dv">0</span>, <span class="at">num_mark_big =</span> <span class="st">","</span>, <span class="at">num_fmt =</span> <span class="st">"decimal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"성별"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"교육"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"투표 대상"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"예측 투표"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"수"</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    ))</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-omgthismodelishorriblelol" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-omgthismodelishorriblelol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
표&nbsp;14.2: 모델은 교육 수준에 관계없이 모든 여성과 많은 남성에 대해 바이든 지지를 예측하고 있습니다.
</figcaption>
<div aria-describedby="tbl-omgthismodelishorriblelol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_a6c565lkrz1xc6g1qmxv(i, j, css_id) {
          var table = document.getElementById("tinytable_a6c565lkrz1xc6g1qmxv");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_a6c565lkrz1xc6g1qmxv');
        // Find the row with data-row attribute matching i
        var targetRow = table.querySelector(`tr [data-row="${i}"]`).closest('tr');
        var newRow = table.insertRow(targetRow.rowIndex);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        newCell.setAttribute("data-col", "0");
        newCell.setAttribute("data-row", i - 1);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_a6c565lkrz1xc6g1qmxv(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_a6c565lkrz1xc6g1qmxv");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '24', j: 4 },  ], css_id: 'tinytable_css_xd8k0ljd5xrg8h9xp9v7',}, 
          { positions: [ { i: '1', j: 4 }, { i: '2', j: 4 }, { i: '3', j: 4 }, { i: '4', j: 4 }, { i: '5', j: 4 }, { i: '6', j: 4 }, { i: '7', j: 4 }, { i: '8', j: 4 }, { i: '9', j: 4 }, { i: '10', j: 4 }, { i: '11', j: 4 }, { i: '12', j: 4 }, { i: '13', j: 4 }, { i: '14', j: 4 }, { i: '15', j: 4 }, { i: '16', j: 4 }, { i: '17', j: 4 }, { i: '18', j: 4 }, { i: '19', j: 4 }, { i: '20', j: 4 }, { i: '21', j: 4 }, { i: '22', j: 4 }, { i: '23', j: 4 },  ], css_id: 'tinytable_css_l291bf7c8cdnd2tps5wv',}, 
          { positions: [ { i: '0', j: 4 },  ], css_id: 'tinytable_css_2ptlg2cr39oectsoc9z3',}, 
          { positions: [ { i: '24', j: 2 }, { i: '24', j: 1 }, { i: '24', j: 0 }, { i: '24', j: 3 },  ], css_id: 'tinytable_css_e69zugixvv4egikqywrn',}, 
          { positions: [ { i: '3', j: 0 }, { i: '1', j: 0 }, { i: '2', j: 0 }, { i: '7', j: 0 }, { i: '4', j: 0 }, { i: '5', j: 0 }, { i: '6', j: 0 }, { i: '11', j: 0 }, { i: '8', j: 0 }, { i: '13', j: 0 }, { i: '14', j: 0 }, { i: '15', j: 0 }, { i: '16', j: 0 }, { i: '17', j: 0 }, { i: '18', j: 0 }, { i: '19', j: 0 }, { i: '20', j: 0 }, { i: '21', j: 0 }, { i: '9', j: 0 }, { i: '23', j: 0 }, { i: '14', j: 2 }, { i: '12', j: 0 }, { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '6', j: 1 }, { i: '7', j: 1 }, { i: '8', j: 1 }, { i: '9', j: 1 }, { i: '22', j: 0 }, { i: '11', j: 1 }, { i: '12', j: 1 }, { i: '13', j: 1 }, { i: '14', j: 1 }, { i: '15', j: 1 }, { i: '16', j: 1 }, { i: '17', j: 1 }, { i: '18', j: 1 }, { i: '19', j: 1 }, { i: '20', j: 1 }, { i: '21', j: 1 }, { i: '22', j: 1 }, { i: '23', j: 1 }, { i: '14', j: 3 }, { i: '10', j: 0 }, { i: '1', j: 2 }, { i: '2', j: 2 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '5', j: 2 }, { i: '6', j: 2 }, { i: '7', j: 2 }, { i: '8', j: 2 }, { i: '9', j: 2 }, { i: '10', j: 2 }, { i: '11', j: 2 }, { i: '12', j: 2 }, { i: '13', j: 2 }, { i: '2', j: 3 }, { i: '15', j: 2 }, { i: '16', j: 2 }, { i: '17', j: 2 }, { i: '18', j: 2 }, { i: '19', j: 2 }, { i: '20', j: 2 }, { i: '21', j: 2 }, { i: '22', j: 2 }, { i: '23', j: 2 }, { i: '12', j: 3 }, { i: '10', j: 1 }, { i: '1', j: 3 }, { i: '15', j: 3 }, { i: '3', j: 3 }, { i: '4', j: 3 }, { i: '5', j: 3 }, { i: '6', j: 3 }, { i: '7', j: 3 }, { i: '8', j: 3 }, { i: '9', j: 3 }, { i: '10', j: 3 }, { i: '11', j: 3 }, { i: '16', j: 3 }, { i: '13', j: 3 }, { i: '18', j: 3 }, { i: '19', j: 3 }, { i: '20', j: 3 }, { i: '17', j: 3 }, { i: '22', j: 3 }, { i: '23', j: 3 }, { i: '21', j: 3 },  ], css_id: 'tinytable_css_yb5jxmdnblm536civngo',}, 
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 3 }, { i: '0', j: 2 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_4q5lmmvo7sj3h2li7o8l',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_a6c565lkrz1xc6g1qmxv(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_xd8k0ljd5xrg8h9xp9v7, .table th.tinytable_css_xd8k0ljd5xrg8h9xp9v7 { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_l291bf7c8cdnd2tps5wv, .table th.tinytable_css_l291bf7c8cdnd2tps5wv { text-align: right; }
      .table td.tinytable_css_2ptlg2cr39oectsoc9z3, .table th.tinytable_css_2ptlg2cr39oectsoc9z3 { text-align: right; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_e69zugixvv4egikqywrn, .table th.tinytable_css_e69zugixvv4egikqywrn { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_yb5jxmdnblm536civngo, .table th.tinytable_css_yb5jxmdnblm536civngo { text-align: left; }
      .table td.tinytable_css_4q5lmmvo7sj3h2li7o8l, .table th.tinytable_css_4q5lmmvo7sj3h2li7o8l { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_a6c565lkrz1xc6g1qmxv" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col" data-row="0" data-col="0">성별</th>
                <th scope="col" data-row="0" data-col="1">교육</th>
                <th scope="col" data-row="0" data-col="2">투표 대상</th>
                <th scope="col" data-row="0" data-col="3">예측 투표</th>
                <th scope="col" data-row="0" data-col="4">수</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td data-row="1" data-col="0">Female</td>
                  <td data-row="1" data-col="1">No HS</td>
                  <td data-row="1" data-col="2">Trump</td>
                  <td data-row="1" data-col="3">Biden</td>
                  <td data-row="1" data-col="4">206</td>
                </tr>
                <tr>
                  <td data-row="2" data-col="0">Female</td>
                  <td data-row="2" data-col="1">No HS</td>
                  <td data-row="2" data-col="2">Biden</td>
                  <td data-row="2" data-col="3">Biden</td>
                  <td data-row="2" data-col="4">228</td>
                </tr>
                <tr>
                  <td data-row="3" data-col="0">Female</td>
                  <td data-row="3" data-col="1">High school graduate</td>
                  <td data-row="3" data-col="2">Trump</td>
                  <td data-row="3" data-col="3">Biden</td>
                  <td data-row="3" data-col="4">3,204</td>
                </tr>
                <tr>
                  <td data-row="4" data-col="0">Female</td>
                  <td data-row="4" data-col="1">High school graduate</td>
                  <td data-row="4" data-col="2">Biden</td>
                  <td data-row="4" data-col="3">Biden</td>
                  <td data-row="4" data-col="4">3,028</td>
                </tr>
                <tr>
                  <td data-row="5" data-col="0">Female</td>
                  <td data-row="5" data-col="1">Some college</td>
                  <td data-row="5" data-col="2">Trump</td>
                  <td data-row="5" data-col="3">Biden</td>
                  <td data-row="5" data-col="4">1,842</td>
                </tr>
                <tr>
                  <td data-row="6" data-col="0">Female</td>
                  <td data-row="6" data-col="1">Some college</td>
                  <td data-row="6" data-col="2">Biden</td>
                  <td data-row="6" data-col="3">Biden</td>
                  <td data-row="6" data-col="4">3,325</td>
                </tr>
                <tr>
                  <td data-row="7" data-col="0">Female</td>
                  <td data-row="7" data-col="1">2-year</td>
                  <td data-row="7" data-col="2">Trump</td>
                  <td data-row="7" data-col="3">Biden</td>
                  <td data-row="7" data-col="4">1,117</td>
                </tr>
                <tr>
                  <td data-row="8" data-col="0">Female</td>
                  <td data-row="8" data-col="1">2-year</td>
                  <td data-row="8" data-col="2">Biden</td>
                  <td data-row="8" data-col="3">Biden</td>
                  <td data-row="8" data-col="4">1,739</td>
                </tr>
                <tr>
                  <td data-row="9" data-col="0">Female</td>
                  <td data-row="9" data-col="1">4-year</td>
                  <td data-row="9" data-col="2">Trump</td>
                  <td data-row="9" data-col="3">Biden</td>
                  <td data-row="9" data-col="4">1,721</td>
                </tr>
                <tr>
                  <td data-row="10" data-col="0">Female</td>
                  <td data-row="10" data-col="1">4-year</td>
                  <td data-row="10" data-col="2">Biden</td>
                  <td data-row="10" data-col="3">Biden</td>
                  <td data-row="10" data-col="4">4,295</td>
                </tr>
                <tr>
                  <td data-row="11" data-col="0">Female</td>
                  <td data-row="11" data-col="1">Post-grad</td>
                  <td data-row="11" data-col="2">Trump</td>
                  <td data-row="11" data-col="3">Biden</td>
                  <td data-row="11" data-col="4">745</td>
                </tr>
                <tr>
                  <td data-row="12" data-col="0">Female</td>
                  <td data-row="12" data-col="1">Post-grad</td>
                  <td data-row="12" data-col="2">Biden</td>
                  <td data-row="12" data-col="3">Biden</td>
                  <td data-row="12" data-col="4">2,853</td>
                </tr>
                <tr>
                  <td data-row="13" data-col="0">Male</td>
                  <td data-row="13" data-col="1">No HS</td>
                  <td data-row="13" data-col="2">Trump</td>
                  <td data-row="13" data-col="3">Trump</td>
                  <td data-row="13" data-col="4">132</td>
                </tr>
                <tr>
                  <td data-row="14" data-col="0">Male</td>
                  <td data-row="14" data-col="1">No HS</td>
                  <td data-row="14" data-col="2">Biden</td>
                  <td data-row="14" data-col="3">Trump</td>
                  <td data-row="14" data-col="4">123</td>
                </tr>
                <tr>
                  <td data-row="15" data-col="0">Male</td>
                  <td data-row="15" data-col="1">High school graduate</td>
                  <td data-row="15" data-col="2">Trump</td>
                  <td data-row="15" data-col="3">Trump</td>
                  <td data-row="15" data-col="4">2,054</td>
                </tr>
                <tr>
                  <td data-row="16" data-col="0">Male</td>
                  <td data-row="16" data-col="1">High school graduate</td>
                  <td data-row="16" data-col="2">Biden</td>
                  <td data-row="16" data-col="3">Trump</td>
                  <td data-row="16" data-col="4">1,528</td>
                </tr>
                <tr>
                  <td data-row="17" data-col="0">Male</td>
                  <td data-row="17" data-col="1">Some college</td>
                  <td data-row="17" data-col="2">Trump</td>
                  <td data-row="17" data-col="3">Biden</td>
                  <td data-row="17" data-col="4">1,992</td>
                </tr>
                <tr>
                  <td data-row="18" data-col="0">Male</td>
                  <td data-row="18" data-col="1">Some college</td>
                  <td data-row="18" data-col="2">Biden</td>
                  <td data-row="18" data-col="3">Biden</td>
                  <td data-row="18" data-col="4">2,131</td>
                </tr>
                <tr>
                  <td data-row="19" data-col="0">Male</td>
                  <td data-row="19" data-col="1">2-year</td>
                  <td data-row="19" data-col="2">Trump</td>
                  <td data-row="19" data-col="3">Trump</td>
                  <td data-row="19" data-col="4">1,089</td>
                </tr>
                <tr>
                  <td data-row="20" data-col="0">Male</td>
                  <td data-row="20" data-col="1">2-year</td>
                  <td data-row="20" data-col="2">Biden</td>
                  <td data-row="20" data-col="3">Trump</td>
                  <td data-row="20" data-col="4">1,026</td>
                </tr>
                <tr>
                  <td data-row="21" data-col="0">Male</td>
                  <td data-row="21" data-col="1">4-year</td>
                  <td data-row="21" data-col="2">Trump</td>
                  <td data-row="21" data-col="3">Biden</td>
                  <td data-row="21" data-col="4">2,208</td>
                </tr>
                <tr>
                  <td data-row="22" data-col="0">Male</td>
                  <td data-row="22" data-col="1">4-year</td>
                  <td data-row="22" data-col="2">Biden</td>
                  <td data-row="22" data-col="3">Biden</td>
                  <td data-row="22" data-col="4">3,294</td>
                </tr>
                <tr>
                  <td data-row="23" data-col="0">Male</td>
                  <td data-row="23" data-col="1">Post-grad</td>
                  <td data-row="23" data-col="2">Trump</td>
                  <td data-row="23" data-col="3">Biden</td>
                  <td data-row="23" data-col="4">1,248</td>
                </tr>
                <tr>
                  <td data-row="24" data-col="0">Male</td>
                  <td data-row="24" data-col="1">Post-grad</td>
                  <td data-row="24" data-col="2">Biden</td>
                  <td data-row="24" data-col="3">Biden</td>
                  <td data-row="24" data-col="4">2,426</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="포아송-회귀" class="level3" data-number="14.2.3">
<h3 data-number="14.2.3" class="anchored" data-anchor-id="포아송-회귀"><span class="header-section-number">14.2.3</span> 포아송 회귀</h3>
<p><code>tidymodels</code>를 사용하여 <code>poissonreg</code><span class="citation" data-cites="poissonreg">(<a href="#ref-poissonreg" role="doc-biblioref">Kuhn 와/과 Frick 2022</a>)</span>로 포아송 모델을 추정할 수 있습니다(<a href="#tbl-modelsummarypoisson" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarypoisson</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>count_of_A <span class="ot">&lt;-</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_parquet</span>(<span class="at">file =</span> <span class="st">"outputs/data/count_of_A.parquet"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>count_of_A_split <span class="ot">&lt;-</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(count_of_A, <span class="at">prop =</span> <span class="fl">0.80</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>count_of_A_train <span class="ot">&lt;-</span> <span class="fu">training</span>(count_of_A_split)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>count_of_A_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(count_of_A_split)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>grades_tidymodels <span class="ot">&lt;-</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poisson_reg</span>(<span class="at">mode =</span> <span class="st">"regression"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    number_of_As <span class="sc">~</span> department,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> count_of_A_train</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이 추정 결과는 <a href="#tbl-modelsummarypoisson의" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarypoisson의</span></a> 두 번째 열에 있습니다. <code>glm()</code>의 추정치와 유사하지만, 분할로 인해 관측치 수가 적습니다.</p>
</section>
</section>
<section id="라쏘-회귀" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="라쏘-회귀"><span class="header-section-number">14.3</span> 라쏘 회귀</h2>
<!-- 텍스트의 좋은 점 중 하나는 기존 방법을 사용하여 입력으로 사용할 수 있다는 것입니다. 여기서는 로지스틱 회귀의 변형과 텍스트 입력을 사용하여 예측할 것입니다. @silge2018에서 영감을 받아 두 가지 다른 텍스트 입력을 사용하여 각각의 텍스트 샘플에서 모델을 훈련한 다음, 해당 모델을 사용하여 훈련 세트의 텍스트를 예측하려고 합니다. 이것은 임의의 예시이지만, 많은 실제 응용 프로그램을 상상할 수 있습니다. 예를 들어, 어떤 텍스트가 봇 또는 인간에 의해 작성되었을 가능성이 있는지에 관심이 있을 수 있습니다. -->
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
거인의 어깨 위에 서서
</div>
</div>
<div class="callout-body-container callout-body">
<p>로버트 팁시라니 박사는 스탠포드 대학교 통계학 및 생의학 데이터 과학과 교수입니다. 1981년 스탠포드 대학교에서 통계학 박사 학위를 받은 후, 토론토 대학교에 조교수로 합류했습니다. 1994년 정교수로 승진했으며 1998년 스탠포드로 옮겼습니다. 그는 위에서 언급된 GAM과 자동 변수 선택 방법인 라쏘 회귀를 포함한 근본적인 기여를 했습니다. 그는 <span class="citation" data-cites="islr의">(<a href="#ref-islr의" role="doc-biblioref"><strong>islr의?</strong></a>)</span> 저자입니다. 그는 1996년 COPSS 회장상을 수상했으며 2019년 왕립 학회 펠로우로 임명되었습니다.</p>
</div>
</div>
<!-- 먼저 데이터를 가져와야 합니다. `gutenbergr`[@gutenbergr]의 `gutenberg_download()`를 사용하여 프로젝트 구텐베르크에서 책을 가져옵니다. *제인 에어*[@janeeyre]와 *이상한 나라의 앨리스*[@citealice]를 고려합니다. -->
<!-- ```{r} -->
<!-- #| include: true -->
<!-- #| message: false -->
<!-- #| warning: false -->
<!-- #| eval: false -->
<!-- library(gutenbergr) -->
<!-- library(tidyverse) -->
<!-- # 관심 있는 책은 각각 1260과 11의 키를 가집니다. -->
<!-- alice_and_jane <- -->
<!--   gutenberg_download( -->
<!--     gutenberg_id = c(1260, 11), -->
<!--     meta_fields = "title" -->
<!--   ) -->
<!-- write_csv(alice_and_jane, "alice_and_jane.csv") -->
<!-- head(alice_and_jane) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- #| include: false -->
<!-- #| eval: true -->
<!-- #| warning: false -->
<!-- #| message: false -->
<!-- library(gutenbergr) -->
<!-- library(tidyverse) -->
<!-- alice_and_jane <- read_csv("inputs/books/alice_and_jane.csv") -->
<!-- head(alice_and_jane) -->
<!-- ``` -->
<!-- 이것의 좋은 점 중 하나는 데이터셋이 티블이라는 것입니다. 따라서 익숙한 모든 기술을 사용할 수 있습니다. 책의 각 줄은 데이터셋의 다른 행으로 읽어들여집니다. 여기서 두 권의 책을 동시에 다운로드했으므로 제목을 추가했습니다. 두 권의 책은 서로 뒤따릅니다. -->
<!-- 각 책의 줄 수를 보면 *제인 에어*가 *이상한 나라의 앨리스*보다 훨씬 길다는 것을 알 수 있습니다. `janitor`[@janitor]의 `remove_empty()`를 사용하여 빈 줄을 제거하는 것으로 시작합니다. -->
<!-- ```{r} -->
<!-- library(janitor) -->
<!-- alice_and_jane <- -->
<!--   alice_and_jane |> -->
<!--   mutate(blank_line = if_else(text == "", 1, 0)) |> -->
<!--   filter(blank_line == 0) |> -->
<!--   select(-blank_line) -->
<!-- table(alice_and_jane$title) -->
<!-- ``` -->
<!-- *제인 에어*는 *이상한 나라의 앨리스*에 비해 여전히 압도적으로 많으므로, 더 균등하게 만들기 위해 *제인 에어*에서 샘플링합니다. -->
<!-- ```{r} -->
<!-- set.seed(853) -->
<!-- alice_and_jane$rows <- c(1:nrow(alice_and_jane)) -->
<!-- sample_from_me <- alice_and_jane |> filter(title == "Jane Eyre: An Autobiography") -->
<!-- keep_me <- sample(x = sample_from_me$rows, size = 2481, replace = FALSE) -->
<!-- alice_and_jane <- -->
<!--   alice_and_jane |>
<!--   filter(title == "Alice's Adventures in Wonderland" | rows %in% keep_me) |>
<!--   select(-rows) -->
<!-- table(alice_and_jane$title) -->
<!-- ``` -->
<!-- 여기에는 다양한 문제가 있습니다. 예를 들어, 앨리스는 전체를 가지고 있지만, 제인은 무작위 부분만 가지고 있습니다. 그럼에도 불구하고 계속해서 각 책의 줄 번호로 카운터를 추가합니다. -->
<!-- ```{r} -->
<!-- alice_and_jane <- -->
<!--   alice_and_jane |> -->
<!--   group_by(title) |> -->
<!--   mutate(line_number = paste(gutenberg_id, row_number(), sep = "_")) |> -->
<!--   ungroup() -->
<!-- ``` -->
<!-- 이제 토큰을 언네스트하고 싶습니다. `tidytext`[@SilgeRobinson2016]의 `unnest_tokens()`를 사용합니다. -->
<!-- ```{r} -->
<!-- #| message: false -->
<!-- #| warning: false -->
<!-- library(tidytext) -->
<!-- alice_and_jane_by_word <- -->
<!--   alice_and_jane |> -->
<!--   unnest_tokens(word, text) |>
<!--   group_by(word) |>
<!--   filter(n() > 10) |>
<!--   ungroup() -->
<!-- ``` -->
<!-- 10번 이상 사용되지 않은 단어는 모두 제거합니다. 그럼에도 불구하고 여전히 500개 이상의 고유 단어가 있습니다. (작가가 최소 10번 단어를 사용하도록 요구하지 않았다면 6,000개 이상의 단어가 남게 됩니다.) -->
<!-- 이것이 관련성이 있는 이유는 이것들이 우리의 독립 변수이기 때문입니다. 따라서 10개 미만의 설명 변수를 사용하는 데 익숙할 수 있지만, 이 경우 585개를 가질 것입니다. 따라서 이를 처리할 수 있는 모델이 필요합니다. -->
<!-- 그러나 앞에서 언급했듯이, 본질적으로 단어 하나만 있는 행이 있을 것입니다. 따라서 모델이 최소한 일부 단어를 사용할 수 있도록 필터링합니다. -->
<!-- ```{r} -->
<!-- alice_and_jane_by_word <- -->
<!--   alice_and_jane_by_word |> -->
<!--   group_by(title, line_number) |> -->
<!--   mutate(number_of_words_in_line = n()) |> -->
<!--   ungroup() |> -->
<!--   filter(number_of_words_in_line > 2) |> -->
<!--   select(-number_of_words_in_line) -->
<!-- ``` -->
<!-- 테스트/훈련 분할을 생성하고 `tidymodels`를 로드합니다. -->
<!-- ```{r} -->
<!-- #| message: false -->
<!-- #| warning: false -->
<!-- library(tidymodels) -->
<!-- set.seed(853) -->
<!-- alice_and_jane_by_word_split <- -->
<!--   alice_and_jane_by_word |> -->
<!--   select(title, line_number) |>
<!--   distinct() |>
<!--   initial_split(prop = 3 / 4, strata = title) -->
<!-- ``` -->
<!-- 그런 다음 `cast_dtm()`을 사용하여 문서-용어 행렬을 생성할 수 있습니다. 이것은 각 단어가 사용된 횟수를 제공합니다. -->
<!-- ```{r} -->
<!-- alice_and_jane_dtm_training <- -->
<!--   alice_and_jane_by_word |> -->
<!--   count(line_number, word) |>
<!--   inner_join(training(alice_and_jane_by_word_split) |> select(line_number)) |>
<!--   cast_dtm(term = word, document = line_number, value = n) -->
<!-- dim(alice_and_jane_dtm_training) -->
<!-- ``` -->
<!-- 따라서 독립 변수는 정렬되었고, 이제 이진 종속 변수가 필요합니다. 즉, 책이 이상한 나라의 앨리스인지 제인 에어인지 여부입니다. -->
<!-- ```{r} -->
<!-- response <- -->
<!--   data.frame(id = dimnames(alice_and_jane_dtm_training)[[1]]) |>
<!--   separate(id, into = c("book", "line", sep = "_")) |>
<!--   mutate(is_alice = if_else(book == 11, 1, 0)) -->
<!-- predictor <- alice_and_jane_dtm_training[] |> as.matrix() -->
<!-- ``` -->
<!-- 이제 모델을 실행할 수 있습니다. -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- library(glmnet) -->
<!-- model <- cv.glmnet( -->
<!--   x = predictor, -->
<!--   y = response$is_alice, -->
<!--   family = "binomial", -->
<!--   keep = TRUE -->
<!-- ) -->
<!-- save(model, file = "alice_vs_jane.rda") -->
<!-- ``` -->
<!-- ```{r}  -->
<!-- #| echo: false -->
<!-- load("outputs/model/alice_vs_jane.rda") -->
<!-- ``` -->
<!-- ```{r} -->
<!-- library(glmnet) -->
<!-- library(broom) -->
<!-- coefs <- model$glmnet.fit |> -->
<!--   tidy() |> -->
<!--   filter(lambda == model$lambda.1se) -->
<!-- coefs |> head() -->
<!-- ``` -->
<!-- ```{r} -->
<!-- coefs |> -->
<!--   group_by(estimate > 0) |> -->
<!--   top_n(10, abs(estimate)) |> -->
<!--   ungroup() |> -->
<!--   ggplot(aes(fct_reorder(term, estimate), estimate, fill = estimate > 0)) + -->
<!--   geom_col(alpha = 0.8, show.legend = FALSE) + -->
<!--   coord_flip() + -->
<!--   theme_minimal() + -->
<!--   labs( -->
<!--     x = "계수", -->
<!--     y = "단어" -->
<!--   ) + -->
<!--   scale_fill_brewer(palette = "Set1") -->
<!-- ``` -->
<!-- 아마도 놀랍지 않게도, 줄에 앨리스가 언급되면 이상한 나라의 앨리스일 가능성이 높고, 제인이 언급되면 제인 에어일 가능성이 높습니다. -->
</section>
<section id="python을-사용한-예측" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="python을-사용한-예측"><span class="header-section-number">14.4</span> Python을 사용한 예측</h2>
<section id="설정" class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="설정"><span class="header-section-number">14.4.1</span> 설정</h3>
<p>Microsoft에서 제공하는 무료 IDE인 VSCode 내에서 Python을 사용할 것입니다. <a href="https://code.visualstudio.com">여기</a>에서 다운로드할 수 있습니다. 그런 다음 Quarto 및 Python 확장을 설치합니다. 이 과정에서 어려움이 있다면, Posit Cloud에서 시작하여 로컬 머신으로 전환했던 것과 마찬가지로, <a href="https://colab.google">여기</a>에서 Google Colab을 처음 사용할 수 있습니다.</p>
</section>
<section id="데이터" class="level3" data-number="14.4.2">
<h3 data-number="14.4.2" class="anchored" data-anchor-id="데이터"><span class="header-section-number">14.4.2</span> 데이터</h3>
<p><em>parquet을 사용하여 데이터 읽기.</em></p>
<p><em>pandas를 사용하여 조작</em></p>
</section>
<section id="모델" class="level3" data-number="14.4.3">
<h3 data-number="14.4.3" class="anchored" data-anchor-id="모델"><span class="header-section-number">14.4.3</span> 모델</h3>
<section id="scikit-learn" class="level4" data-number="14.4.3.1">
<h4 data-number="14.4.3.1" class="anchored" data-anchor-id="scikit-learn"><span class="header-section-number">14.4.3.1</span> scikit-learn</h4>
</section>
<section id="tensorflow" class="level4" data-number="14.4.3.2">
<h4 data-number="14.4.3.2" class="anchored" data-anchor-id="tensorflow"><span class="header-section-number">14.4.3.2</span> TensorFlow</h4>
</section>
</section>
</section>
<section id="연습-문제" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="연습-문제"><span class="header-section-number">14.5</span> 연습 문제</h2>
<section id="연습" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="연습">연습</h3>
<ol type="1">
<li><em>(계획)</em> 다음 시나리오를 고려하십시오: <em>1년 동안 매일 삼촌과 당신은 다트를 합니다. 각 라운드는 각각 세 개의 다트를 던지는 것으로 구성됩니다. 각 라운드 끝에 세 개의 다트가 맞춘 점수를 합산합니다. 따라서 3, 5, 10을 맞추면 해당 라운드의 총 점수는 18입니다. 삼촌은 다소 자비로워서 5점 미만을 맞추면 못 본 척하고 해당 다트를 다시 던질 기회를 줍니다. 매일 15라운드를 한다고 가정하십시오.</em> 데이터셋이 어떻게 생겼을지 스케치한 다음, 모든 관측치를 보여주기 위해 만들 수 있는 그래프를 스케치하십시오.</li>
<li><em>(시뮬레이션)</em> 설명된 시나리오를 더 고려하고 상황을 시뮬레이션하십시오. 삼촌의 총점과 다시 던질 기회가 없었을 때의 총점, 그리고 실제로 얻게 되는 총점을 비교하십시오. 시뮬레이션된 데이터를 기반으로 최소 10개의 테스트를 포함하십시오.</li>
<li><em>(수집)</em> 그러한 데이터셋의 가능한 출처를 설명하십시오(또는 관심 있는 동등한 스포츠 또는 상황).</li>
<li><em>(탐색)</em> <code>ggplot2</code>를 사용하여 스케치한 그래프를 만드십시오. 그런 다음 <code>tidymodels</code>를 사용하여 누가 이길지 예측하는 모델을 구축하십시오.</li>
<li><em>(소통)</em> 자신이 한 일에 대해 두 단락을 작성하십시오.</li>
</ol>
</section>
<section id="퀴즈" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="퀴즈">퀴즈</h3>
</section>
<section id="수업-활동" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="수업-활동">수업 활동</h3>
</section>
<section id="과제" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="과제">과제</h3>
<p><code>nflverse</code>를 사용하여 정규 시즌 동안 NFL 쿼터백에 대한 일부 통계를 로드하십시오. <a href="https://nflreadr.nflverse.com/articles/dictionary_player_stats.html">데이터 사전</a>은 데이터를 이해하는 데 유용할 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>qb_regular_season_stats <span class="ot">&lt;-</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load_player_stats</span>(<span class="at">seasons =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(season_type <span class="sc">==</span> <span class="st">"REG"</span> <span class="sc">&amp;</span> position <span class="sc">==</span> <span class="st">"QB"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>NFL 분석가라고 가정하고 2023년 정규 시즌의 절반, 즉 9주차가 막 끝났다고 가정하십시오. 시즌의 나머지 부분, 즉 10-18주차에 각 팀에 대해 생성할 수 있는 <code>passing_epa</code>의 최상의 예측 모델에 관심이 있습니다.</p>
<p>Quarto를 사용하고, 적절한 제목, 저자, 날짜, GitHub 리포지토리 링크, 섹션 및 인용을 포함하고, 경영진을 위한 2-3페이지 보고서를 작성하십시오. 최상의 성능은 창의적인 기능 엔지니어링을 필요로 할 것입니다. R 또는 Python, 어떤 모델이든 사용할 수 있지만, 모델을 지정하고 작동 방식을 높은 수준에서 설명하는 데 주의해야 합니다. 데이터 누출에 주의하십시오!</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-tinytable" class="csl-entry" role="listitem">
Arel-Bundock, Vincent. 2024. <em><span>tinytable: Simple and Configurable Tables in <span>“HTML”</span>, <span>“LaTeX”</span>, <span>“Markdown”</span>, <span>“Word”</span>, <span>“PNG”</span>, <span>“PDF”</span>, and <span>“Typst”</span> Formats</span></em>. <a href="https://vincentarelbundock.github.io/tinytable/">https://vincentarelbundock.github.io/tinytable/</a>.
</div>
<div id="ref-nflverse" class="csl-entry" role="listitem">
Carl, Sebastian, Ben Baldwin, Lee Sharpe, Tan Ho, 와/과 John Edwards. 2023. <em>nflverse: Easily Install and Load the ’nflverse’</em>. <a href="https://CRAN.R-project.org/package=nflverse">https://CRAN.R-project.org/package=nflverse</a>.
</div>
<div id="ref-congelio2024" class="csl-entry" role="listitem">
Congelio, Bradley. 2024. <em><span>Introduction to NFL Analytics with R</span></em>. 1st ed. Chapman; Hall/CRC. <a href="https://bradcongelio.com/nfl-analytics-with-r-book/">https://bradcongelio.com/nfl-analytics-with-r-book/</a>.
</div>
<div id="ref-rsample" class="csl-entry" role="listitem">
Frick, Hannah, Fanny Chow, Max Kuhn, Michael Mahoney, Julia Silge, 와/과 Hadley Wickham. 2022. <em><span>rsample: General Resampling Infrastructure</span></em>. <a href="https://CRAN.R-project.org/package=rsample">https://CRAN.R-project.org/package=rsample</a>.
</div>
<div id="ref-islr" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, 와/과 Robert Tibshirani. (2013년) 2021. <em><span>An Introduction to Statistical Learning with Applications in R</span></em>. 2nd ed. Springer. <a href="https://www.statlearning.com">https://www.statlearning.com</a>.
</div>
<div id="ref-tune" class="csl-entry" role="listitem">
Kuhn, Max. 2022. <em><span>tune: Tidy Tuning Tools</span></em>. <a href="https://CRAN.R-project.org/package=tune">https://CRAN.R-project.org/package=tune</a>.
</div>
<div id="ref-poissonreg" class="csl-entry" role="listitem">
Kuhn, Max, 와/과 Hannah Frick. 2022. <em><span>poissonreg: Model Wrappers for Poisson Regression</span></em>. <a href="https://CRAN.R-project.org/package=poissonreg">https://CRAN.R-project.org/package=poissonreg</a>.
</div>
<div id="ref-parsnip" class="csl-entry" role="listitem">
Kuhn, Max, 와/과 Davis Vaughan. 2022. <em><span>parsnip: A Common API to Modeling and Analysis Functions</span></em>. <a href="https://CRAN.R-project.org/package=parsnip">https://CRAN.R-project.org/package=parsnip</a>.
</div>
<div id="ref-yardstick" class="csl-entry" role="listitem">
Kuhn, Max, Davis Vaughan, 와/과 Emil Hvitfeldt. 2022. <em><span>yardstick: Tidy Characterizations of Model Performance</span></em>. <a href="https://CRAN.R-project.org/package=yardstick">https://CRAN.R-project.org/package=yardstick</a>.
</div>
<div id="ref-citeTidymodels" class="csl-entry" role="listitem">
Kuhn, Max, 와/과 Hadley Wickham. 2020. <em><span>tidymodels: a collection of packages for modeling and machine learning using tidyverse principles</span></em>. <a href="https://www.tidymodels.org">https://www.tidymodels.org</a>.
</div>
<div id="ref-recipes" class="csl-entry" role="listitem">
———. 2022. <em><span>recipes: Preprocessing and Feature Engineering Steps for Modeling</span></em>. <a href="https://CRAN.R-project.org/package=recipes">https://CRAN.R-project.org/package=recipes</a>.
</div>
<div id="ref-pythonfordataanalysis" class="csl-entry" role="listitem">
McKinney, Wes. (2011년) 2022. <em>Python for Data Analysis</em>. 3rd ed. <a href="https://wesmckinney.com/book/">https://wesmckinney.com/book/</a>.
</div>
<div id="ref-arrow" class="csl-entry" role="listitem">
Richardson, Neal, Ian Cook, Nic Crane, Dewey Dunnington, Romain François, Jonathan Keane, Dragoș Moldovan-Grünfeld, Jeroen Ooms, 와/과 Apache Arrow. 2023. <em><span>arrow: Integration to Apache Arrow</span></em>. <a href="https://CRAN.R-project.org/package=arrow">https://CRAN.R-project.org/package=arrow</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jenny Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, 기타. 2019. <span>“<span>Welcome to the Tidyverse</span>”</span>. <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "복사완료!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "복사완료!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/tellingstorieswithdata\.com\/mybook");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./13-ijaglm_ko.html" class="pagination-link" aria-label="일반화 선형 모델">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">일반화 선형 모델</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14-causality_from_obs_ko.html" class="pagination-link" aria-label="관찰 데이터에서 인과 관계">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">관찰 데이터에서 인과 관계</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/RohanAlexander/telling_stories/edit/main/13-prediction_ko.qmd" class="toc-action"><i class="bi bi-github"></i>편집</a></li></ul></div></div></div></footer></body></html>