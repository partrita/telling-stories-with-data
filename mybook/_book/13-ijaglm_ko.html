<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>13&nbsp; 일반화 선형 모델 – 데이터로 이야기하기</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./13-prediction_ko.html" rel="next">
<link href="./12-ijalm_ko.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b22ef3f334bfc3d7f06e555e13679c65.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-ijalm_ko.html">모델링</a></li><li class="breadcrumb-item"><a href="./13-ijaglm_ko.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">일반화 선형 모델</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="검색" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">데이터로 이야기하기</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/RohanAlexander/telling_stories/" title="소스 코드" class="quarto-navigation-tool px-1" aria-label="소스 코드"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서문</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-errata_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">오류 및 업데이트</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">기초</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">데이터로 이야기하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-drinking_from_a_fire_hose_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">소방 호스에서 마시기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-workflow_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">재현 가능한 워크플로우</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">소통</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-writing_research_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">연구 작성</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-graphs_tables_maps_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">그래프, 표, 지도</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">획득</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-farm_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">측정, 인구 조사, 표본 추출</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-gather_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">API, 스크래핑, 파싱</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-hunt_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">실험 및 설문 조사</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">준비</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-clean_and_prepare_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">정리, 준비 및 테스트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-store_and_share_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">저장 및 공유</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-eda_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">모델링</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-ijalm_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 모델</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-ijaglm_ko.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">일반화 선형 모델</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-prediction_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">예측</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">적용</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-causality_from_obs_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">관찰 데이터에서 인과 관계</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-mrp_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">사후 층화 다단계 회귀</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-text_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">데이터로서의 텍스트</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-concluding_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">17-concluding_ko.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">부록</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-r_essentials_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R 필수 사항</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-python_essentials_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Python 필수 사항</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-sql_essentials_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">SQL 필수</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-datasets_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">데이터셋</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-rmarkdown_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">R 마크다운</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-papers_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">논문</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-deploy_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">생산</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98-cocktails_ko.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">칵테일</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#internal" id="toc-internal" class="nav-link active" data-scroll-target="#internal"><span class="header-section-number">14</span> INTERNAL</a>
  <ul class="collapse">
  <li><a href="#포아송-회귀" id="toc-포아송-회귀" class="nav-link" data-scroll-target="#포아송-회귀"><span class="header-section-number">14.1</span> 포아송 회귀</a></li>
  </ul></li>
  <li><a href="#internal-1" id="toc-internal-1" class="nav-link" data-scroll-target="#internal-1"><span class="header-section-number">15</span> INTERNAL</a>
  <ul class="collapse">
  <li><a href="#제인-에어에-사용된-문자" id="toc-제인-에어에-사용된-문자" class="nav-link" data-scroll-target="#제인-에어에-사용된-문자"><span class="header-section-number">15.0.1</span> <em>제인 에어</em>에 사용된 문자</a></li>
  </ul></li>
  <li><a href="#internal-2" id="toc-internal-2" class="nav-link" data-scroll-target="#internal-2"><span class="header-section-number">16</span> INTERNAL</a></li>
  <li><a href="#internal-3" id="toc-internal-3" class="nav-link" data-scroll-target="#internal-3"><span class="header-section-number">17</span> INTERNAL</a></li>
  <li><a href="#internal-4" id="toc-internal-4" class="nav-link" data-scroll-target="#internal-4"><span class="header-section-number">18</span> INTERNAL</a></li>
  <li><a href="#년-초에-다운로드된-원본-데이터셋을-참조합니다.-이-장을-업데이트할-때-업데이트된-데이터셋으로-돌아와-업데이트하십시오." id="toc-년-초에-다운로드된-원본-데이터셋을-참조합니다.-이-장을-업데이트할-때-업데이트된-데이터셋으로-돌아와-업데이트하십시오." class="nav-link" data-scroll-target="#년-초에-다운로드된-원본-데이터셋을-참조합니다.-이-장을-업데이트할-때-업데이트된-데이터셋으로-돌아와-업데이트하십시오."><span class="header-section-number">19</span> 2023년 초에 다운로드된 원본 데이터셋을 참조합니다. 이 장을 업데이트할 때 업데이트된 데이터셋으로 돌아와 업데이트하십시오.</a></li>
  <li><a href="#internal-5" id="toc-internal-5" class="nav-link" data-scroll-target="#internal-5"><span class="header-section-number">20</span> INTERNAL</a>
  <ul class="collapse">
  <li><a href="#오스틴-브론테-디킨스-셰익스피어" id="toc-오스틴-브론테-디킨스-셰익스피어" class="nav-link" data-scroll-target="#오스틴-브론테-디킨스-셰익스피어"><span class="header-section-number">20.0.1</span> 오스틴, 브론테, 디킨스, 셰익스피어</a></li>
  </ul></li>
  <li><a href="#중복-및-원치-않는-문자에-대한-문서-값" id="toc-중복-및-원치-않는-문자에-대한-문서-값" class="nav-link" data-scroll-target="#중복-및-원치-않는-문자에-대한-문서-값"><span class="header-section-number">21</span> 중복 및 원치 않는 문자에 대한 문서 값</a></li>
  <li><a href="#internal-6" id="toc-internal-6" class="nav-link" data-scroll-target="#internal-6"><span class="header-section-number">22</span> INTERNAL</a></li>
  <li><a href="#internal-7" id="toc-internal-7" class="nav-link" data-scroll-target="#internal-7"><span class="header-section-number">23</span> INTERNAL</a>
  <ul class="collapse">
  <li><a href="#결론" id="toc-결론" class="nav-link" data-scroll-target="#결론"><span class="header-section-number">23.1</span> 결론</a></li>
  <li><a href="#연습-문제" id="toc-연습-문제" class="nav-link" data-scroll-target="#연습-문제"><span class="header-section-number">23.2</span> 연습 문제</a>
  <ul class="collapse">
  <li><a href="#연습" id="toc-연습" class="nav-link" data-scroll-target="#연습">연습</a></li>
  <li><a href="#퀴즈" id="toc-퀴즈" class="nav-link" data-scroll-target="#퀴즈">퀴즈</a></li>
  <li><a href="#수업-활동" id="toc-수업-활동" class="nav-link" data-scroll-target="#수업-활동">수업 활동</a></li>
  <li><a href="#과제" id="toc-과제" class="nav-link" data-scroll-target="#과제">과제</a></li>
  <li><a href="#논문" id="toc-논문" class="nav-link" data-scroll-target="#논문">논문</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/RohanAlexander/telling_stories/edit/main/13-ijaglm_ko.qmd" class="toc-action"><i class="bi bi-github"></i>편집</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-ijalm_ko.html">모델링</a></li><li class="breadcrumb-item"><a href="./13-ijaglm_ko.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">일반화 선형 모델</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-its-just-a-generalized-linear-model" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">일반화 선형 모델</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Chapman and Hall/CRC에서 2023년 7월에 이 책을 출판했습니다. <a href="https://www.routledge.com/Telling-Stories-with-Data-With-Applications-in-R/Alexander/p/book/9781032134772">여기</a>에서 구매할 수 있습니다.</p>
<p>이 온라인 버전은 인쇄된 내용에서 일부 업데이트되었습니다. 인쇄 버전과 일치하는 온라인 버전은 <a href="https://rohanalexander.github.io/telling_stories-published/">여기</a>에서 사용할 수 있습니다.</p>
</div>
</div>
</div>
<p><strong>선수 지식</strong></p>
<ul>
<li><em>회귀 및 기타 이야기</em>, <span class="citation" data-cites="gelmanhillvehtari2020">(<a href="#ref-gelmanhillvehtari2020" role="doc-biblioref">Gelman, Hill, 와/과 Vehtari 2020</a>)</span>
<ul>
<li>일반화 선형 모델에 대한 자세한 가이드를 제공하는 13장 “로지스틱 회귀” 및 15장 “기타 일반화 선형 모델”에 집중하세요.</li>
</ul></li>
<li><em>R을 사용한 통계 학습 소개</em>, <span class="citation" data-cites="islr">(<a href="#ref-islr" role="doc-biblioref">James 기타 [2013년] 2021</a>)</span>
<ul>
<li>다른 관점에서 일반화 선형 모델에 대한 보완적인 처리를 제공하는 4장 “분류”에 집중하세요.</li>
</ul></li>
<li><em>우리는 네 명의 훌륭한 여론 조사원에게 동일한 원시 데이터를 주었다. 그들은 네 가지 다른 결과를 얻었다</em>, <span class="citation" data-cites="cohn2016">(<a href="#ref-cohn2016" role="doc-biblioref">Cohn 2016</a>)</span>
<ul>
<li>동일한 데이터셋이 주어졌을 때 다른 모델링 선택이 다른 예측으로 이어지는 상황을 자세히 설명합니다.</li>
</ul></li>
</ul>
<p><strong>핵심 개념 및 기술</strong></p>
<ul>
<li>선형 회귀는 대체 유형의 결과 변수에 대해 일반화될 수 있습니다.</li>
<li>로지스틱 회귀는 이진 결과 변수가 있을 때 사용할 수 있습니다.</li>
<li>포아송 회귀는 정수 개수 결과 변수가 있을 때 사용할 수 있습니다. 음이항 회귀는 가정이 덜 까다롭기 때문에 종종 고려되는 변형입니다.</li>
<li>다단계 모델링은 데이터를 더 잘 활용할 수 있는 접근 방식입니다.</li>
</ul>
<p><strong>소프트웨어 및 패키지</strong></p>
<ul>
<li>Base R <span class="citation" data-cites="citeR">(<a href="#ref-citeR" role="doc-biblioref">R Core Team 2024</a>)</span></li>
<li><code>boot</code> <span class="citation" data-cites="boot bootii">(<a href="#ref-boot" role="doc-biblioref">Canty 와/과 Ripley 2021</a>; <a href="#ref-bootii" role="doc-biblioref">Davison 와/과 Hinkley 1997</a>)</span></li>
<li><code>broom.mixed</code> <span class="citation" data-cites="mixedbroom">(<a href="#ref-mixedbroom" role="doc-biblioref">Bolker 와/과 Robinson 2022</a>)</span></li>
<li><code>collapse</code> <span class="citation" data-cites="collapse">(<a href="#ref-collapse" role="doc-biblioref">Krantz 2023</a>)</span></li>
<li><code>dataverse</code> <span class="citation" data-cites="dataverse">(<a href="#ref-dataverse" role="doc-biblioref">Kuriwaki, Beasley, 와/과 Leeper 2023</a>)</span></li>
<li><code>gutenbergr</code> <span class="citation" data-cites="gutenbergr">(<a href="#ref-gutenbergr" role="doc-biblioref">Johnston 와/과 Robinson 2022</a>)</span></li>
<li><code>janitor</code> <span class="citation" data-cites="janitor">(<a href="#ref-janitor" role="doc-biblioref">Firke 2023</a>)</span></li>
<li><code>marginaleffects</code> <span class="citation" data-cites="marginaleffects">(<a href="#ref-marginaleffects" role="doc-biblioref">Arel-Bundock 2023</a>)</span></li>
<li><code>modelsummary</code> <span class="citation" data-cites="citemodelsummary">(<a href="#ref-citemodelsummary" role="doc-biblioref">Arel-Bundock 2022</a>)</span></li>
<li><code>rstanarm</code> <span class="citation" data-cites="citerstanarm">(<a href="#ref-citerstanarm" role="doc-biblioref">Goodrich 기타 2023</a>)</span></li>
<li><code>tidybayes</code> <span class="citation" data-cites="citetidybayes">(<a href="#ref-citetidybayes" role="doc-biblioref">Kay 2022</a>)</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">Wickham 기타 2019</a>)</span></li>
<li><code>tinytable</code> <span class="citation" data-cites="tinytable">(<a href="#ref-tinytable" role="doc-biblioref">Arel-Bundock 2024</a>)</span></li>
</ul>
<p>```{ r} #| message: false #| warning: false</p>
<p>library(boot) library(broom.mixed) library(collapse) library(dataverse) library(gutenbergr) library(janitor) library(marginaleffects) library(modelsummary) library(rstanarm) library(tidybayes) library(tidyverse) library(tinytable)</p>
<pre><code>
## 서론

@sec-its-just-a-linear-model에서 다루었던 선형 모델은 지난 세기 동안 상당히 발전했습니다.\index{statistics!history of} @sec-hunt-data에서 언급된 프랜시스 골턴\index{Galton, Francis}과 그의 세대 사람들은 1800년대 후반과 1900년대 초반에 선형 회귀를 진지하게 사용했습니다. 이진 결과는 빠르게 관심의 대상이 되었고 특별한 처리가 필요했으며, 이는 1900년대 중반에 로지스틱 회귀 및 유사한 방법의 개발과 광범위한 적용으로 이어졌습니다[@cramer2002origins]. 일반화 선형 모델 프레임워크는 1970년대에 @nelder1972generalized에 의해 공식적인 의미로 등장했습니다. 일반화 선형 모델(GLM)\index{linear models!generalized}은 허용되는 결과의 유형을 확장합니다. 우리는 여전히 결과를 선형 함수로 모델링하지만, 제약이 덜합니다. 결과는 지수족에 속하는 어떤 것이든 될 수 있으며, 인기 있는 선택에는 로지스틱 분포와 포아송 분포가 포함됩니다. 완성된 이야기를 위해 이 책의 범위를 벗어나는 접근 방식으로 전환하면, GLM의 추가 일반화는 일반화 가법 모델(GAM)이며, 여기서 설명 측면의 구조를 확장합니다. 우리는 여전히 결과 변수를 다양한 조각의 가법 함수로 설명하지만, 그 조각들은 함수가 될 수 있습니다. 이 프레임워크는 1990년대에 @hastie1990generalized에 의해 제안되었습니다.

일반화 선형 모델 측면에서, 이 장에서는 로지스틱, 포아송, 음이항 회귀를 다룹니다. 그러나 선형 모델과 일반화 선형 모델 모두와 관련된 변형인 다단계 모델링도 탐색합니다. 이는 데이터셋 내에 존재하는 어떤 유형의 그룹화를 활용하는 경우입니다.

## 로지스틱 회귀

선형 회귀\index{regression!logistic}\index{logistic regression}는 데이터를 더 잘 이해하는 데 유용한 방법입니다. 그러나 이는 실수선상의 어떤 숫자도 취할 수 있는 연속 결과 변수를 가정합니다. 이 조건을 충족할 수 없을 때 동일한 메커니즘을 사용하고 싶습니다. 이진 및 개수 결과 변수에 대해 각각 로지스틱 및 포아송 회귀로 전환합니다. 예측 변수가 선형 방식으로 들어가기 때문에 여전히 선형 모델입니다.

로지스틱 회귀\index{logistic regression} 및 그 변형은 선거[@wang2015forecasting]부터 경마[@chellel2018gambler; @boltonruth]에 이르기까지 다양한 설정에서 유용합니다. 결과 변수가 0 또는 1, 또는 "예" 또는 "아니오"와 같은 이진 결과일 때 로지스틱 회귀를 사용합니다. 이진 결과 변수\index{binary outcome}의 존재가 제한적으로 들릴 수 있지만, 결과가 자연스럽게 이 상황에 속하거나 조정될 수 있는 많은 상황이 있습니다. 예를 들어, 승리 또는 패배, 사용 가능 또는 사용 불가능, 지지 또는 비지지.

이것의 기초는 베르누이 분포\index{distribution!Bernoulli}입니다. 결과 "1"의 확률 $p$가 있고, 나머지 $1-p$는 결과 "0"에 대한 것입니다. `rbinom()`을 한 번의 시행("size = 1")으로 사용하여 베르누이 분포에서 데이터를 시뮬레이션할 수 있습니다.\index{simulation}

```{
r}
#| message: false
#| warning: false

set.seed(853)

bernoulli_example &lt;-
  tibble(draws = rbinom(n = 20, size = 1, prob = 0.1))

bernoulli_example |&gt; pull(draws)</code></pre>
<p>로지스틱 회귀를 사용하는 한 가지 이유는 확률을 모델링할 것이므로 0과 1 사이에 제한될 것이기 때문입니다. 선형 회귀에서는 이 범위를 벗어나는 값을 얻을 수 있습니다. 로지스틱 회귀의 기초는 로짓 함수입니다.</p>
<p><span class="math display">\[
\mbox{logit}(x) = \log\left(\frac{x}{1-x}\right).
\]</span> 이것은 0과 1 사이의 값을 실수선으로 변환합니다. 예를 들어, <code>logit(0.1) = -2.2</code>, <code>logit(0.5) = 0</code>, <code>logit(0.9) = 2.2</code>입니다(<a href="#fig-heyitslogit" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-heyitslogit</span></a>). 우리는 이것을 “링크 함수”라고 부릅니다. 이는 일반화 선형 모델에서 관심 있는 분포를 선형 모델에서 사용하는 메커니즘과 연결합니다.</p>
<p>```{ r} #| eval: true #| include: true #| echo: false #| fig-cap: “0과 1 사이의 값에 대한 로짓 함수의 예시” #| label: fig-heyitslogit #| message: false #| warning: false</p>
<p>tibble(values = seq(from = 0, to = 1, by = 0.001), logit = logit(values)) |&gt; ggplot(aes(x = values, y = logit)) + geom_line() + theme_classic() + geom_hline(yintercept = 0, linetype = “dashed”) + labs(x = “x 값”, y = “logit(x)”)</p>
<pre><code>
### 시뮬레이션 예시: 낮 또는 밤

로지스틱 회귀\index{logistic regression}를 설명하기 위해, 도로 위의 자동차 수를 기반으로 주중 또는 주말인지 여부에 대한 데이터를 시뮬레이션할 것입니다.\index{simulation} 주중에는 도로가 더 혼잡하다고 가정할 것입니다.\index{distribution!Normal}

```{
r}
#| message: false
#| warning: false

set.seed(853)

week_or_weekday &lt;-
  tibble(
    num_cars = sample.int(n = 100, size = 1000, replace = TRUE),
    noise = rnorm(n = 1000, mean = 0, sd = 10),
    is_weekday = if_else(num_cars + noise &gt; 50, 1, 0)
  ) |&gt;
  select(-noise)

week_or_weekday</code></pre>
<p>```{ r} #| eval: false #| include: false</p>
<p>arrow::write_parquet(x = week_or_weekday, sink = “outputs/data/week_or_weekday.parquet”)</p>
<pre><code>
base R의 `glm()`을 사용하여 빠른 추정을 수행할 수 있습니다.\index{logistic regression!Base R} 이 경우, 우리가 볼 수 있는 자동차 수를 기반으로 주중 또는 주말인지 여부를 파악하려고 노력할 것입니다. @eq-logisticexample를 추정하는 데 관심이 있습니다.

$$
\mbox{Pr}(y_i=1) = \mbox{logit}^{-1}\left(\beta_0+\beta_1 x_i\right)
$$ {#eq-logisticexample}

여기서 $y_i$는 주중인지 여부이고 $x_i$는 도로 위의 자동차 수입니다.


```{
r}
week_or_weekday_model &lt;-
  glm(
    is_weekday ~ num_cars,
    data = week_or_weekday,
    family = "binomial"
  )

summary(week_or_weekday_model)</code></pre>
<p>자동차 수에 대한 추정 계수는 0.19입니다. 로지스틱 회귀에서 계수의 해석은 이진 결과의 로그-오즈 변화와 관련되므로 선형 회귀보다 더 복잡합니다. 예를 들어, 0.19의 추정치는 도로에서 자동차 한 대를 더 관찰할 때 주중일 로그-오즈의 평균 변화입니다. 계수는 양수이므로 증가를 의미합니다. 비선형이므로 특정 변화를 지정하려면 관측치의 다른 기준 수준에 따라 달라집니다. 즉, 0.19 로그-오즈의 증가는 기준 로그-오즈가 2일 때보다 0일 때 더 큰 영향을 미칩니다.</p>
<p>우리는 추정치를 주어진 자동차 수에 대한 주중일 확률로 변환할 수 있습니다. <code>marginaleffects</code>의 <code>predictions()</code>를 사용하여 각 관측치에 대한 주중일 암시된 확률을 추가할 수 있습니다.</p>
<p>```{ r} week_or_weekday_predictions &lt;- predictions(week_or_weekday_model) |&gt; as_tibble()</p>
<p>week_or_weekday_predictions</p>
<pre><code>
그리고 각 관측치에 대해 모델이 암시하는 주중일 확률을 그래프로 그릴 수 있습니다(@fig-dayornightprobs). 이것은 적합도를 설명하는 몇 가지 다른 방법을 고려할 수 있는 좋은 기회입니다. 산점도를 사용하는 것이 일반적이지만(@fig-dayornightprobs-1), ECDF를 사용하는 것도 가능합니다(@fig-dayornightprobs-2).

```{
r}
#| eval: true
#| fig-cap: "주변 자동차 수를 기반으로 주중 또는 주말인지 여부에 대한 시뮬레이션된 데이터를 사용한 로지스틱 회귀 확률 결과"
#| include: true
#| label: fig-dayornightprobs
#| message: false
#| warning: false
#| fig-subcap: ["산점도로 적합도 설명", "ECDF로 적합도 설명"]
#| layout-ncol: 2

# 패널 (a)
week_or_weekday_predictions |&gt;
  mutate(is_weekday = factor(is_weekday)) |&gt;
  ggplot(aes(x = num_cars, y = estimate, color = is_weekday)) +
  geom_jitter(width = 0.01, height = 0.01, alpha = 0.3) +
  labs(
    x = "관찰된 자동차 수",
    y = "주중일 추정 확률",
    color = "실제 주중"
  ) +
  theme_classic() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom")

# 패널 (b)
week_or_weekday_predictions |&gt;
  mutate(is_weekday = factor(is_weekday)) |&gt;
  ggplot(aes(x = num_cars, y = estimate, color = is_weekday)) +
  stat_ecdf(geom = "point", alpha = 0.75) +
  labs(
    x = "관찰된 자동차 수",
    y = "주중일 추정 확률",
    color = "실제 주중"
  ) +
  theme_classic() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom")</code></pre>
<p>각 관측치에서의 한계 효과는 이 확률이 어떻게 변하는지 보여주므로 흥미롭습니다. 이를 통해 중앙값(이 경우 자동차 50대를 볼 경우)에서 주중일 확률이 자동차 한 대를 더 볼 경우 거의 5% 증가한다고 말할 수 있습니다(<a href="#tbl-marginaleffectcar" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-marginaleffectcar</span></a>).</p>
<p>```{ r} #| label: tbl-marginaleffectcar #| tbl-cap: “중앙값에서 자동차 한 대가 주중일 확률에 미치는 한계 효과”</p>
<p>slopes(week_or_weekday_model, newdata = “median”) |&gt; select(term, estimate, std.error) |&gt; tt() |&gt; style_tt(j = 1:3, align = “lrr”) |&gt; format_tt(digits = 3, num_mark_big = “,”, num_fmt = “decimal”) |&gt; setNames(c(“항목”, “추정치”, “표준 오차”))</p>
<pre><code>
상황을 더 철저히 조사하기 위해 `rstanarm`을 사용하여 베이즈 모델을 구축하고 싶을 수 있습니다.\index{Bayesian!logistic regression}\index{logistic regression!Bayesian} @sec-its-just-a-linear-model에서와 마찬가지로 모델에 대한 사전 분포를 지정할 것이지만, 이는 `rstanarm`이 사용하는 기본 사전 분포일 뿐입니다.

$$
\begin{aligned}
y_i|\pi_i &amp; \sim \mbox{Bern}(\pi_i) \\
\mbox{logit}(\pi_i) &amp; = \beta_0+\beta_1 x_i \\
\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)\\
\beta_1 &amp; \sim \mbox{Normal}(0, 2.5)
\end{aligned}
$$
여기서 $y_i$는 주중인지 여부(실제로는 0 또는 1)이고 $x_i$는 도로 위의 자동차 수이며, $\pi_i$는 관측치 $i$가 주중일 확률입니다.

```{
r}
#| eval: false
#| echo: true
#| message: false
#| warning: false

week_or_weekday_rstanarm &lt;-
  stan_glm(
    is_weekday ~ num_cars,
    data = week_or_weekday,
    family = binomial(link = "logit"),
    prior = normal(location = 0, scale = 2.5, autoscale = TRUE),
    prior_intercept = normal(location = 0, scale = 2.5, autoscale = TRUE),
    seed = 853
  )

saveRDS(
  week_or_weekday_rstanarm,
  file = "week_or_weekday_rstanarm.rds"
)</code></pre>
<p>```{ r} #| eval: false #| include: false #| message: false #| warning: false</p>
<section id="internal" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> INTERNAL</h1>
<p>saveRDS( week_or_weekday_rstanarm, file = “outputs/model/week_or_weekday_rstanarm.rds” )</p>
<pre><code>
```{
r}
#| eval: true
#| include: false
#| message: false
#| warning: false

week_or_weekday_rstanarm &lt;-
  readRDS(file = "outputs/model/week_or_weekday_rstanarm.rds")</code></pre>
<p>베이즈 모델의 결과는 base를 사용하여 구축한 빠른 모델과 유사합니다(<a href="#tbl-modelsummarylogistic" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarylogistic</span></a>).</p>
<p>```{ r} #| label: tbl-modelsummarylogistic #| tbl-cap: “도로 위의 자동차 수를 기반으로 낮 또는 밤인지 설명” #| message: false #| warning: false</p>
<p>modelsummary( list( “낮 또는 밤” = week_or_weekday_rstanarm ) )</p>
<pre><code>
@tbl-modelsummarylogistic는 이 경우 각 접근 방식이 유사하다는 것을 분명히 합니다. 그들은 주중일 확률에 대한 추가 자동차 한 대의 효과 방향에 동의합니다. 심지어 효과의 크기도 유사하게 추정됩니다.


### 미국 정치적 지지

로지스틱 회귀가 자주 사용되는 분야 중 하나는 정치 여론 조사입니다.\index{United States!political polling} 많은 경우 투표는 하나의 선호도 순위가 필요하다는 것을 의미하며, 따라서 문제는 적절하든 아니든 "지지" 또는 "비지지"로 축소됩니다.\index{elections!US 2020 Presidential Election}

이 책에서 옹호하는 워크플로는 다음과 같습니다.\index{workflow}

$$\mbox{계획} \rightarrow \mbox{시뮬레이션} \rightarrow \mbox{획득} \rightarrow \mbox{탐색} \rightarrow \mbox{공유}$$

여기서는 모델을 사용한 데이터 탐색에 초점을 맞추지만, 다른 측면도 수행해야 합니다. 계획부터 시작합니다. 이 경우, 우리는 미국 정치적 지지에 관심이 있습니다. 특히 응답자의 최고 교육 수준과 성별만으로 응답자가 누구에게 투표할 가능성이 있는지 예측할 수 있는지에 관심이 있습니다. 이는 개인이 누구에게 투표했는지, 그리고 성별 및 교육과 같은 특성에 대한 변수가 있는 데이터셋에 관심이 있다는 것을 의미합니다. 그러한 데이터셋의 빠른 스케치는 @fig-uspoliticalsupportsketch입니다. 우리는 모델이 이러한 점들을 평균화하기를 원합니다. 빠른 스케치는 @fig-uspoliticalsupportmodel입니다.

::: {#fig-uspoliticalsuppor layout-ncol=2 layout-valign="bottom"}

![미국 정치적 지지를 조사하는 데 사용할 수 있는 데이터셋의 빠른 스케치](figures/IMG_2054.png){#fig-uspoliticalsupportsketch}

![데이터 또는 분석을 최종화하기 전에 분석에서 예상하는 것에 대한 빠른 스케치](figures/IMG_2055.png){#fig-uspoliticalsupportmodel}

예상 데이터셋 및 분석 초점의 스케치는 나중에 업데이트될지라도 우리의 생각을 집중하고 명확하게 합니다.
:::

개인이 바이든을 지지할 확률이 성별과 교육에 따라 달라지는 데이터셋을 시뮬레이션할 것입니다.\index{simulation}

```{
r}
set.seed(853)

num_obs &lt;- 1000

us_political_preferences &lt;- tibble(
  education = sample(0:4, size = num_obs, replace = TRUE),
  gender = sample(0:1, size = num_obs, replace = TRUE),
  support_prob = ((education + gender) / 5),
) |&gt;
  mutate(
    supports_biden = if_else(runif(n = num_obs) &lt; support_prob, "yes", "no"),
    education = case_when(
      education == 0 ~ "&lt; 고등학교",
      education == 1 ~ "고등학교",
      education == 2 ~ "일부 대학",
      education == 3 ~ "대학",
      education == 4 ~ "대학원"
    ),
    gender = if_else(gender == 0, "남성", "여성")
  ) |&gt;
  select(-support_prob, supports_biden, gender, education)</code></pre>
<p>실제 데이터의 경우 2020년 협동 선거 연구 (CES) <span class="citation" data-cites="cooperativeelectionstudyus">(<a href="#ref-cooperativeelectionstudyus" role="doc-biblioref">Schaffner, Ansolabehere, 와/과 Luks 2021</a>)</span>를 사용할 수 있습니다. 이것은 미국 정치 여론에 대한 오랜 연례 설문 조사입니다. 2020년에는 61,000명의 응답자가 선거 후 설문 조사를 완료했습니다. <span class="citation" data-cites="guidetothe2020ces">Ansolabehere, Schaffner, 와/과 Luks (<a href="#ref-guidetothe2020ces" role="doc-biblioref">2021</a>, p.&nbsp;13)</span>에 자세히 설명된 표본 추출 방법론은 매칭에 의존하며, 표본 추출 문제와 비용의 균형을 맞추는 허용된 접근 방식입니다.</p>
<p><code>dataverse</code>를 설치하고 로드한 후 <code>get_dataframe_by_name()</code>을 사용하여 CES에 접근할 수 있습니다. 이 접근 방식은 <a href="#sec-gather-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-gather-data</span></a> 및 <a href="#sec-store-and-share에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-store-and-share에서</span></a> 소개되었습니다. 우리는 관심 있는 데이터를 저장한 다음, 저장된 데이터셋을 참조합니다.</p>
<p>```{ r} #| echo: true #| eval: false</p>
<p>ces2020 &lt;- get_dataframe_by_name( filename = “CES20_Common_OUTPUT_vv.csv”, dataset = “10.7910/DVN/E9N6PH”, server = “dataverse.harvard.edu”, .f = read_csv ) |&gt; select(votereg, CC20_410, gender, educ)</p>
<p>write_csv(ces2020, “ces2020.csv”)</p>
<pre><code>
```{
r}
#| echo: false
#| eval: false

# INTERNAL

write_csv(ces2020, "inputs/data/ces2020.csv")</code></pre>
<p>```{ r} #| echo: true #| eval: false</p>
<p>ces2020 &lt;- read_csv( “ces2020.csv”, col_types = cols( “votereg” = col_integer(), “CC20_410” = col_integer(), “gender” = col_integer(), “educ” = col_integer() ) )</p>
<p>ces2020</p>
<pre><code>
```{
r}
#| echo: false
#| eval: true

# INTERNAL

ces2020 &lt;-
  read_csv(
    "inputs/data/ces2020.csv",
    col_types =
      cols(
        "votereg" = col_integer(),
        "CC20_410" = col_integer(),
        "gender" = col_integer(),
        "educ" = col_integer()
      )
  )

ces2020</code></pre>
<p>실제 데이터를 보면, 스케치에서 예상하지 못했던 문제들이 있습니다. 코드북을 사용하여 이를 더 철저히 조사합니다. 우리는 투표 등록된 응답자만 원하며, 바이든 또는 트럼프에게 투표한 사람들에게만 관심이 있습니다. 변수 “CC20_410”이 1이면 응답자가 바이든을 지지했고, 2이면 트럼프를 지지했음을 의미합니다. 해당 응답자만 필터링한 다음 더 유익한 레이블을 추가할 수 있습니다. CES에서 “여성”과 “남성” 성별을 사용할 수 있으며, 변수 “gender”가 1이면 “남성”을 의미하고, 2이면 “여성”을 의미합니다. 마지막으로, 코드북은 “educ”가 교육 수준이 증가하는 1부터 6까지의 변수라고 알려줍니다.</p>
<p><code>{ r} ces2020 &lt;-   ces2020 |&gt;   filter(votereg == 1,          CC20_410 %in% c(1, 2)) |&gt;   mutate(     voted_for = if_else(CC20_410 == 1, "Biden", "Trump"),     voted_for = as_factor(voted_for),     gender = if_else(gender == 1, "남성", "여성"),     education = case_when(       educ == 1 ~ "고등학교 미만",       educ == 2 ~ "고등학교 졸업",       educ == 3 ~ "일부 대학",       educ == 4 ~ "2년제",       educ == 5 ~ "4년제",       educ == 6 ~ "대학원"     ),     education = factor(       education,       levels = c(         "고등학교 미만",         "고등학교 졸업",         "일부 대학",         "2년제",         "4년제",         "대학원"       )     )   ) |&gt;   select(voted_for, gender, education)</code></p>
<p>```{ r} #| eval: false #| include: false</p>
<p>arrow::write_parquet(x = ces2020, sink = “outputs/data/ces2020.parquet”)</p>
<pre><code>
결과적으로 43,554명의 응답자가 남았습니다(@fig-cesissogooditslikecheating).

```{
r}
#| eval: true
#| echo: true
#| message: false
#| warning: false
#| fig-cap: "성별 및 최고 교육 수준별 대통령 선호도 분포"
#| label: fig-cesissogooditslikecheating

ces2020 |&gt;
  ggplot(aes(x = education, fill = voted_for)) +
  stat_count(position = "dodge") +
  facet_wrap(facets = vars(gender)) +
  theme_minimal() +
  labs(
    x = "최고 교육 수준",
    y = "응답자 수",
    fill = "투표 대상"
  ) +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") +
  theme(legend.position = "bottom")</code></pre>
<p>우리가 관심 있는 모델은 다음과 같습니다.</p>
<p><span class="math display">\[
\begin{aligned}
y_i|\pi_i &amp; \sim \mbox{Bern}(\pi_i) \\
\mbox{logit}(\pi_i) &amp; = \beta_0+\beta_1 \times \mbox{gender}_i + \beta_2 \times \mbox{education}_i \\
\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)\\
\beta_1 &amp; \sim \mbox{Normal}(0, 2.5)\\
\beta_2 &amp; \sim \mbox{Normal}(0, 2.5)
\end{aligned}
\]</span></p>
<p>여기서 <span class="math inline">\(y_i\)</span>는 응답자의 정치적 선호도이며 바이든이면 1, 트럼프이면 0입니다. <span class="math inline">\(\mbox{gender}_i\)</span>는 응답자의 성별이고 <span class="math inline">\(\mbox{education}_i\)</span>는 응답자의 교육 수준입니다. <code>stan_glm()</code>을 사용하여 매개변수를 추정할 수 있습니다. 모델은 일반적으로 허용되는 약어입니다. 실제로는 <code>rstanarm</code>은 범주형 변수를 일련의 지표 변수로 변환하며 여러 계수가 추정됩니다. 실행 시간을 고려하여 전체 데이터셋 대신 1,000개의 관측치를 무작위로 샘플링하여 모델을 적합할 것입니다.</p>
<p>```{ r} #| eval: false #| echo: true #| message: false #| warning: false</p>
<p>set.seed(853)</p>
<p>ces2020_reduced &lt;- ces2020 |&gt; slice_sample(n = 1000)</p>
<p>political_preferences &lt;- stan_glm( voted_for ~ gender + education, data = ces2020_reduced, family = binomial(link = “logit”), prior = normal(location = 0, scale = 2.5, autoscale = TRUE), prior_intercept = normal(location = 0, scale = 2.5, autoscale = TRUE), seed = 853 )</p>
<p>saveRDS( political_preferences, file = “political_preferences.rds” )</p>
<pre><code>
```{
r}
#| eval: false
#| echo: false

# INTERNAL

saveRDS(
  political_preferences,
  file = "outputs/model/political_preferences.rds"
)</code></pre>
<p>```{ r} #| echo: true #| eval: false #| message: false #| warning: false</p>
<p>political_preferences &lt;- readRDS(file = “political_preferences.rds”)</p>
<pre><code>
```{
r}
#| eval: true
#| include: false
#| message: false
#| warning: false

political_preferences &lt;-
  readRDS(file = "outputs/model/political_preferences.rds")</code></pre>
<p>모델 결과는 흥미롭습니다. 남성이 바이든에게 투표할 가능성이 낮고, 교육 수준에 상당한 영향을 미친다는 것을 시사합니다(<a href="#tbl-modelsummarylogisticpolitical" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarylogisticpolitical</span></a>).</p>
<p>```{ r} #| label: tbl-modelsummarylogisticpolitical #| tbl-cap: “성별 및 교육 수준을 기반으로 응답자가 바이든에게 투표할 가능성” #| message: false #| warning: false</p>
<p>modelsummary( list( “바이든 지지” = political_preferences ), statistic = “mad” )</p>
<pre><code>
이러한 예측 변수의 신뢰 구간을 플로팅하는 것이 유용할 수 있습니다(@fig-modelplotlogisticpolitical). 특히 부록에서 특히 유용할 수 있습니다.

```{
r}
#| label: tbl-modelplotlogisticpolitical
#| fig-cap: "바이든 지지 예측 변수에 대한 신뢰 구간"

modelplot(political_preferences, conf_level = 0.9) +
  labs(x = "90% 신뢰 구간")</code></pre>
<section id="포아송-회귀" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="포아송-회귀"><span class="header-section-number">14.1</span> 포아송 회귀</h2>
<p>개수 데이터가 있을 때 처음에는 포아송 분포를 활용하는 것을 고려해야 합니다. 포아송 회귀의 한 가지 응용은 스포츠 결과 모델링입니다. 예를 들어 <span class="citation" data-cites="Burch2023은">(<a href="#ref-Burch2023은" role="doc-biblioref"><strong>Burch2023은?</strong></a>)</span> <span class="citation" data-cites="Baio2010이">(<a href="#ref-Baio2010이" role="doc-biblioref"><strong>Baio2010이?</strong></a>)</span> 축구 결과의 포아송 모델을 구축한 것을 따라 하키 결과의 포아송 모델을 구축합니다.</p>
<p>포아송 분포는 하나의 매개변수 <span class="math inline">\(\lambda\)</span>에 의해 결정됩니다. 이는 음수가 아닌 정수에 대한 확률을 분포시키므로 분포의 모양을 결정합니다. 따라서 포아송 분포는 평균이 분산과 동일하다는 흥미로운 특징을 가집니다. 평균이 증가하면 분산도 증가합니다. 포아송 확률 질량 함수는 다음과 같습니다<span class="citation" data-cites="pitman">(<a href="#ref-pitman" role="doc-biblioref">Pitman 1993</a>, p.&nbsp;121)</span>.</p>
<p><span class="math display">\[P_{\lambda}(k) = e^{-\lambda}\lambda^k/k!\mbox{, for }k=0,1,2,\dots\]</span> <code>rpois()</code>를 사용하여 <span class="math inline">\(\lambda\)</span>가 3인 포아송 분포에서 <span class="math inline">\(n=20\)</span>개의 표본을 시뮬레이션할 수 있습니다.</p>
<p><code>{ r} rpois(n = 20, lambda = 3)</code></p>
<p><span class="math inline">\(\lambda\)</span> 값을 변경할 때 분포에 어떤 일이 발생하는지 살펴볼 수도 있습니다(<a href="#fig-poissondistributiontakingshape" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-poissondistributiontakingshape</span></a>).</p>
<p>```{ r} #| eval: true #| include: true #| echo: false #| message: false #| warning: false #| fig-cap: “포아송 분포는 평균 값에 의해 결정되며, 이는 분산과 동일합니다.” #| label: fig-poissondistributiontakingshape</p>
<p>set.seed(853)</p>
<p>number_of_each &lt;- 100</p>
<p>lambdas &lt;- c(0, 1, 2, 4, 7, 10, 15, 25, 50)</p>
<p>poisson_takes_shape &lt;- map(lambdas, ~ tibble(lambda = rep(.x, number_of_each), draw = rpois(n = number_of_each, lambda = .x))) |&gt; list_rbind()</p>
<p>poisson_takes_shape &lt;- poisson_takes_shape |&gt; mutate(lambda = paste(“lambda =”, lambda), lambda = factor(lambda, levels = paste(“lambda =”, lambdas)))</p>
<p>ggplot(poisson_takes_shape, aes(x = draw)) + geom_density() + facet_wrap(vars(lambda), scales = “free_y”) + theme_minimal() + labs(x = “정수”, y = “밀도”)</p>
<pre><code>
### 시뮬레이션 예시: 학과별 A 학점 수

상황을 설명하기 위해 각 대학 과정에서 부여되는 A 학점 수에 대한 데이터를 시뮬레이션할 수 있습니다.\index{simulation} 이 시뮬레이션된 예시에서는 세 개의 학과를 고려하며, 각 학과에는 많은 과정이 있습니다. 각 과정은 다른 수의 A 학점을 부여할 것입니다.\index{distribution!Poisson}

```{
r}
set.seed(853)

class_size &lt;- 26

count_of_A &lt;-
  tibble(
    # Chris DuBois에서: https://stackoverflow.com/a/1439843
    department = 
      c(rep.int("1", 26), rep.int("2", 26), rep.int("3", 26)),
    course = c(
      paste0("DEP_1_", letters),
      paste0("DEP_2_", letters),
      paste0("DEP_3_", letters)
    ),
    number_of_As = c(
      rpois(n = class_size, lambda = 5),
      rpois(n = class_size, lambda = 10),
      rpois(n = class_size, lambda = 20)
    )
  )</code></pre>
<p>```{ r} #| eval: false #| include: false</p>
<p>arrow::write_parquet(x = count_of_A, sink = “outputs/data/count_of_A.parquet”)</p>
<pre><code>
```{
r}
#| echo: true
#| eval: true
#| message: false
#| warning: false
#| fig-cap: "세 학과에 걸쳐 다양한 수업에서 시뮬레이션된 A 학점 수"
#| label: fig-simgradesdepartments

count_of_A |&gt;
  ggplot(aes(x = number_of_As)) +
  geom_histogram(aes(fill = department), position = "dodge") +
  labs(
    x = "부여된 A 학점 수",
    y = "수업 수",
    fill = "학과"
  ) +
  theme_classic() +
  scale_fill_brewer(palette = "Set1") +
  theme(legend.position = "bottom")</code></pre>
<p>시뮬레이션된 데이터셋은 학과 내에 구조화된 과정별 A 학점 수를 가지고 있습니다(<a href="#fig-simgradesdepartments" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-simgradesdepartments</span></a>). <a href="#sec-multilevel-regression-with-post-stratification에서는" class="quarto-xref"><span class="quarto-unresolved-ref">sec-multilevel-regression-with-post-stratification에서는</span></a> 이 학과 구조를 활용할 것이지만, 지금은 이를 무시하고 학과 간의 차이에 초점을 맞출 것입니다.</p>
<p>우리가 추정하는 데 관심 있는 모델은 다음과 같습니다.</p>
<p><span class="math display">\[
\begin{aligned}
y_i|\lambda_i &amp;\sim \mbox{Poisson}(\lambda_i)\\
\log(\lambda_i) &amp; = \beta_0 + \beta_1 \times \mbox{department}_i
\end{aligned}
\]</span> 여기서 <span class="math inline">\(y_i\)</span>는 부여된 A 학점 수이며, 학과별로 어떻게 다른지에 관심이 있습니다.</p>
<p>base R의 <code>glm()</code>을 사용하여 데이터를 빠르게 파악할 수 있습니다. 이 함수는 매우 일반적이며, “family” 매개변수를 설정하여 포아송 회귀를 지정합니다. 추정치는 <a href="#tbl-modelsummarypoisson의" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarypoisson의</span></a> 첫 번째 열에 포함되어 있습니다.</p>
<p>```{ r} grades_base &lt;- glm( number_of_As ~ department, data = count_of_A, family = “poisson” )</p>
<p>summary(grades_base)</p>
<pre><code>
로지스틱 회귀와 마찬가지로 포아송 회귀\index{regression!Poisson}에서 계수의 해석은 어려울 수 있습니다. "department2"의 계수 해석은 학과 간 예상 차이의 로그입니다. 학과 1과 비교하여 학과 2와 3에서 각각 $e^{0.883} \approx 2.4$배 및 $e^{1.703} \approx 5.5$배 많은 A 학점을 예상합니다(@tbl-modelsummarypoisson).

베이즈 모델을 구축하고 `rstanarm`으로 추정할 수 있습니다(@tbl-modelsummarypoisson).

$$
\begin{aligned}
y_i|\lambda_i &amp;\sim \mbox{Poisson}(\lambda_i)\\
\log(\lambda_i) &amp; = \beta_0 + \beta_1 \times\mbox{department}_i\\
\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)\\
\beta_1 &amp; \sim \mbox{Normal}(0, 2.5)
\end{aligned}
$$
여기서 $y_i$는 부여된 A 학점 수입니다.

```{
r}
#| include: true
#| message: false
#| warning: false
#| eval: false

grades_rstanarm &lt;-
  stan_glm(
    number_of_As ~ department,
    data = count_of_A,
    family = poisson(link = "log"),
    prior = normal(location = 0, scale = 2.5, autoscale = TRUE),
    prior_intercept = normal(location = 0, scale = 2.5, autoscale = TRUE),
    seed = 853
  )

saveRDS(
  grades_rstanarm,
  file = "grades_rstanarm.rds"
)</code></pre>
<p>```{ r} #| eval: false #| include: false #| message: false #| warning: false</p>
</section>
</section>
<section id="internal-1" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> INTERNAL</h1>
<p>saveRDS( grades_rstanarm, file = “outputs/model/grades_rstanarm.rds” )</p>
<pre><code>
```{
r}
#| eval: true
#| include: false
#| message: false
#| warning: false

grades_rstanarm &lt;-
  readRDS(file = "outputs/model/grades_rstanarm.rds")</code></pre>
<p>결과는 <a href="#tbl-modelsummarypoisson에" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarypoisson에</span></a> 있습니다.</p>
<p>```{ r} #| label: tbl-modelsummarypoisson #| tbl-cap: “다른 학과에서 부여된 A 학점 수 조사”</p>
<p>modelsummary( list( “A 학점 수” = grades_rstanarm ) )</p>
<pre><code>
로지스틱 회귀와 마찬가지로 `marginaleffects`의 `slopes()`를 사용하여 이러한 결과를 해석하는 데 도움을 받을 수 있습니다.\index{marginal effects} 한 학과에서 다른 학과로 이동할 때 A 학점 수가 어떻게 변할 것으로 예상하는지 고려하는 것이 유용할 수 있습니다. @tbl-marginaleffectspoisson은 데이터셋에서 학과 2의 수업이 학과 1보다 약 5개의 A 학점을 더 많이 받는 경향이 있고, 학과 3의 수업이 학과 1보다 약 17개의 A 학점을 더 많이 받는 경향이 있음을 시사합니다.

```{
r}
#| label: tbl-marginaleffectspoisson
#| tbl-cap: "각 학과에서 부여된 A 학점 수의 추정된 차이"

slopes(grades_rstanarm) |&gt;
  select(contrast, estimate, conf.low, conf.high) |&gt;
  unique() |&gt; 
  tt() |&gt; 
  style_tt(j = 1:4, align = "lrrr") |&gt; 
  format_tt(digits = 2, num_mark_big = ",", num_fmt = "decimal") |&gt; 
  setNames(c("학과 비교", "추정치", "2.5%", "97.5%"))</code></pre>
<section id="제인-에어에-사용된-문자" class="level3" data-number="15.0.1">
<h3 data-number="15.0.1" class="anchored" data-anchor-id="제인-에어에-사용된-문자"><span class="header-section-number">15.0.1</span> <em>제인 에어</em>에 사용된 문자</h3>
<p>이전 시대에 <span class="citation" data-cites="edgeworth1885methods는">(<a href="#ref-edgeworth1885methods는" role="doc-biblioref"><strong>edgeworth1885methods는?</strong></a>)</span> 버질의 <em>아이네이스</em>에서 닥틸 수를 세었습니다(<span class="citation" data-cites="Stigler1978">Stigler (<a href="#ref-Stigler1978" role="doc-biblioref">1978</a>, p.&nbsp;301)</span>은 유용한 배경 정보와 <code>HistData</code>의 <code>Dactyl</code>을 사용하여 데이터셋을 제공합니다<span class="citation" data-cites="HistData">(<a href="#ref-HistData" role="doc-biblioref">Friendly 2021</a>)</span>). 이에 영감을 받아 <code>gutenbergr</code>를 사용하여 샬럿 브론테의 <em>제인 에어</em> 텍스트를 가져올 수 있습니다. (<a href="#sec-gather-data에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-gather-data에서</span></a> <em>제인 에어</em>의 PDF를 데이터셋으로 변환하는 방법을 보여주었습니다.) 그런 다음 각 장의 처음 10줄을 고려하고, 단어 수를 세고, “E” 또는 “e”가 나타나는 횟수를 셀 수 있습니다. 단어 수가 증가함에 따라 e/E의 수가 증가하는지 여부에 관심이 있습니다. 그렇지 않다면, e/E의 분포가 일관되지 않다는 것을 시사할 수 있으며, 이는 언어학자들에게 흥미로울 수 있습니다.</p>
<p>이 책에서 옹호하는 워크플로를 따라, 먼저 데이터셋과 모델을 스케치합니다. 데이터셋이 어떻게 생겼을지에 대한 빠른 스케치는 <a href="#fig-letterssketch이고" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-letterssketch이고</span></a>, 모델에 대한 빠른 스케치는 <a href="#fig-lettersmodel입니다" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-lettersmodel입니다</span></a>.</p>
<div id="fig-letterss" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-letterss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-letterss" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-letterssketch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-letterssketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/IMG_2056.png" class="img-fluid figure-img" data-ref-parent="fig-letterss">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-letterssketch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <em>제인 에어</em>의 줄 및 장별 계획된 개수
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-letterss" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-lettersmodel" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-lettersmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/IMG_2075.png" class="img-fluid figure-img" data-ref-parent="fig-letterss">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-lettersmodel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 줄의 e/E 개수와 단어 수 사이의 예상 관계
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-letterss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
그림&nbsp;15.1: 예상 데이터셋 및 분석 스케치는 우리가 관심 있는 것을 고려하도록 강요합니다.
</figcaption>
</figure>
</div>
<p>포아송 분포를 따라 e/E의 수가 어떻게 분포될 수 있는지에 대한 데이터셋을 시뮬레이션합니다(<a href="#fig-simenum" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-simenum</span></a>).</p>
<p>```{ r} #| echo: true #| eval: true #| message: false #| warning: false #| fig-cap: “e/E의 시뮬레이션된 개수” #| label: fig-simenum</p>
<p>count_of_e_simulation &lt;- tibble( chapter = c(rep(1, 10), rep(2, 10), rep(3, 10)), line = rep(1:10, 3), number_words_in_line = runif(min = 0, max = 15, n = 30) |&gt; round(0), number_e = rpois(n = 30, lambda = 10) )</p>
<p>count_of_e_simulation |&gt; ggplot(aes(y = number_e, x = number_words_in_line)) + geom_point() + labs( x = “줄의 단어 수”, y = “처음 10줄의 e/E 수” ) + theme_classic() + scale_fill_brewer(palette = “Set1”)</p>
<pre><code>
이제 데이터를 수집하고 준비할 수 있습니다. `gutenbergr`의 `gutenberg_download()`를 사용하여 프로젝트 구텐베르크에서 책 텍스트를 다운로드합니다.\index{text!gathering}\index{Project Gutenberg}

```{
r}
#| eval: false
#| echo: true

gutenberg_id_of_janeeyre &lt;- 1260

jane_eyre &lt;-
  gutenberg_download(
    gutenberg_id = gutenberg_id_of_janeeyre,
    mirror = "https://gutenberg.pglaf.org/"
  )

jane_eyre

write_csv(jane_eyre, "jane_eyre.csv")</code></pre>
<p>다운로드한 다음 프로젝트 구텐베르크 서버에 과도한 부담을 주지 않기 위해 로컬 사본을 사용할 것입니다.</p>
<p>```{ r} #| eval: false #| echo: false</p>
</section>
</section>
<section id="internal-2" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> INTERNAL</h1>
<p>write_csv(jane_eyre, “inputs/jane_eyre.csv”)</p>
<pre><code>
```{
r}
#| eval: false
#| echo: true

jane_eyre &lt;- read_csv(
  "jane_eyre.csv",
  col_types = cols(
    gutenberg_id = col_integer(),
    text = col_character()
  )
)

jane_eyre</code></pre>
<p>```{ r} #| eval: true #| echo: false</p>
</section>
<section id="internal-3" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> INTERNAL</h1>
<p>jane_eyre &lt;- read_csv( “inputs/jane_eyre.csv”, col_types = cols( gutenberg_id = col_integer(), text = col_character() ) )</p>
<p>jane_eyre</p>
<pre><code>
내용이 있는 줄에만 관심이 있으므로 간격을 위해 있는 빈 줄은 제거합니다.\index{text!cleaning} 그런 다음 각 장의 처음 10줄에 대해 해당 줄의 e/E 수를 계산할 수 있습니다. 예를 들어, 처음 몇 줄을 보면 첫 줄에 5개의 e/E가 있고 두 번째 줄에 8개가 있음을 알 수 있습니다.

```{
r}
jane_eyre_reduced &lt;-
  jane_eyre |&gt;
  filter(!is.na(text)) |&gt; # 빈 줄 제거
  mutate(chapter = if_else(str_detect(text, "CHAPTER") == TRUE,
                           text,
                           NA_character_)) |&gt; # 장 시작 찾기
  fill(chapter, .direction = "down") |&gt; 
  mutate(chapter_line = row_number(), 
         .by = chapter) |&gt; # 각 장에 줄 번호 추가
  filter(!is.na(chapter), 
         chapter_line %in% c(2:11)) |&gt; # "CHAPTER I" 등 제거
  select(text, chapter) |&gt;
  mutate(
    chapter = str_remove(chapter, "CHAPTER "),
    chapter = str_remove(chapter, "—CONCLUSION"),
    chapter = as.integer(as.roman(chapter))
  ) |&gt; # 장을 정수로 변경
  mutate(
    count_e = str_count(text, "e|E"),
    word_count = str_count(text, "\\w+")
         # 출처: https://stackoverflow.com/a/38058033
         ) </code></pre>
<p><code>{ r} jane_eyre_reduced |&gt;   select(chapter, word_count, count_e, text) |&gt;   head()</code></p>
<p>e/E 수의 평균과 분산이 대략 비슷하다는 것을 모든 데이터를 플로팅하여 확인할 수 있습니다(<a href="#fig-janeecounts" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-janeecounts</span></a>). 분홍색으로 표시된 평균은 6.7이고, 파란색으로 표시된 분산은 6.2입니다. 완전히 동일하지는 않지만 비슷합니다. 데이터에 대해 생각하는 데 도움이 되도록 <a href="#fig-janeecounts-2에" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-janeecounts-2에</span></a> 대각선을 포함합니다. 데이터가 <span class="math inline">\(y=x\)</span> 선에 있다면, 평균적으로 단어당 하나의 e/E가 있을 것입니다. 해당 선 아래의 점들의 질량을 고려할 때, 평균적으로 단어당 하나 미만일 것으로 예상합니다.</p>
<p>```{ r} #| echo: true #| eval: true #| fig-cap: “제인 에어 각 장의 처음 10줄에 있는 e/E 문자 수” #| label: fig-janeecounts #| message: false #| warning: false #| layout-ncol: 2 #| fig-subcap: [“e/E 수의 분포”, “줄의 e/E 수와 단어 수 비교”]</p>
<p>mean_e &lt;- mean(jane_eyre_reduced<span class="math inline">\(count_e)
variance_e &lt;- var(jane_eyre_reduced\)</span>count_e)</p>
<p>jane_eyre_reduced |&gt; ggplot(aes(x = count_e)) + geom_histogram() + geom_vline(xintercept = mean_e, linetype = “dashed”, color = “#C64191”) + geom_vline(xintercept = variance_e, linetype = “dashed”, color = “#0ABAB5”) + theme_minimal() + labs( y = “개수”, x = “처음 10줄의 줄당 e 수” )</p>
<p>jane_eyre_reduced |&gt; ggplot(aes(x = word_count, y = count_e)) + geom_jitter(alpha = 0.5) + geom_abline(slope = 1, intercept = 0, linetype = “dashed”) + theme_minimal() + labs( x = “줄의 단어 수”, y = “줄의 e/E 수” )</p>
<pre><code>
다음 모델을 고려할 수 있습니다.

$$
\begin{aligned}
y_i|\lambda_i &amp;\sim \mbox{Poisson}(\lambda_i)\\
\log(\lambda_i) &amp; = \beta_0 + \beta_1 \times \mbox{단어 수}_i\\
\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)\\
\beta_1 &amp; \sim \mbox{Normal}(0, 2.5)
\end{aligned}
$$
여기서 $y_i$는 줄의 e/E 수이고 설명 변수는 줄의 단어 수입니다. `stan_glm()`을 사용하여 모델을 추정할 수 있습니다.

```{
r}
#| eval: false
#| echo: true
#| message: false
#| warning: false

jane_e_counts &lt;-
  stan_glm(
    count_e ~ word_count,
    data = jane_eyre_reduced,
    family = poisson(link = "log"),
    prior = normal(location = 0, scale = 2.5, autoscale = TRUE),
    prior_intercept = normal(location = 0, scale = 2.5, autoscale = TRUE),
    seed = 853
  )

saveRDS(
  jane_e_counts,
  file = "jane_e_counts.rds"
)</code></pre>
<p>```{ r} #| eval: false #| echo: false</p>
</section>
<section id="internal-4" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> INTERNAL</h1>
<p>saveRDS( jane_e_counts, file = “outputs/model/jane_e_counts.rds” )</p>
<pre><code>
```{
r}
#| eval: true
#| include: false
#| message: false
#| warning: false

jane_e_counts &lt;-
  readRDS(file = "outputs/model/jane_e_counts.rds")</code></pre>
<!-- (@tbl-modelsummaryjanee). -->
<!-- ```{r} -->
<!-- #| label: tbl-modelsummaryjanee -->
<!-- #| tbl-cap: "도로 위의 자동차 수를 기반으로 낮 또는 밤인지 예측 및 설명 모델" -->
<!-- modelsummary::modelsummary( -->
<!--   list( -->
<!--     "rstanarm" = jane_e_counts -->
<!--   ), -->
<!--   statistic = "mad" -->
<!-- ) -->
<!-- ``` -->
<p>일반적으로 추정치 표에 관심이 있겠지만, 지금은 몇 번 보았으므로 추정치 표를 다시 만드는 대신 <code>marginaleffects</code>의 <code>plot_cap()</code>을 소개합니다. 이를 사용하여 모델이 예측한 e/E 수를 각 줄의 단어 수를 기반으로 표시할 수 있습니다. <a href="#fig-predictionsjaneecounts는" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-predictionsjaneecounts는</span></a> 양의 관계를 예상한다는 것을 분명히 합니다.</p>
<p>```{ r} #| label: tbl-predictionsjaneecounts #| fig-cap: “단어 수를 기반으로 각 줄의 e/E 예측 수”</p>
<p>plot_predictions(jane_e_counts, condition = “word_count”) + labs(x = “단어 수”, y = “처음 10줄의 평균 e/E 수”) + theme_classic()</p>
<pre><code>
## 음이항 회귀

포아송 회귀의 제약 중 하나는 평균과 분산이 동일하다는 가정입니다. 음이항 회귀\index{regression!negative binomial}라는 유사한 변형을 사용하여 과분산을 허용하도록 이 가정을 완화할 수 있습니다.

포아송 및 음이항 모델은 서로 밀접하게 관련되어 있습니다. 종종 두 모델을 모두 적합한 다음 비교하게 됩니다. 예를 들어:

- @maher1982modelling은 잉글랜드 축구 리그 결과의 맥락에서 두 모델을 모두 고려하고, 어떤 모델이 다른 모델보다 더 적절하다고 간주될 수 있는 상황을 논의합니다.
- @thanksleo는 2000년 미국 대통령 선거와 특히 포아송 분석에서 과분산 문제를 고려합니다.
- @Osgood2000은 범죄 데이터의 경우 두 모델을 비교합니다.

&lt;!-- 음이항 분포의 모양은 성공 확률 $p$와 성공 횟수 $r$이라는 두 매개변수에 의해 결정됩니다[@pitman, p. 482]. --&gt;

&lt;!-- $$P(F_r = n) = {n+r-1\choose r-1}p^r(1-p)^n\mbox{, for }n=0,1,2,...$$ --&gt;
&lt;!-- 여기서 $F_r$은 베르누이 시행에서 $r$번째 성공 전의 실패 횟수입니다. --&gt;

&lt;!-- 예를 들어, *제인 에어*의 동일한 줄에서 k의 수를 고려한다면, 많은 0이 있을 것입니다(@fig-janeecountsk). --&gt;

&lt;!-- ```{r} --&gt;
&lt;!-- jane_eyre_reduced &lt;- --&gt;
&lt;!--   jane_eyre_reduced |&gt; --&gt;
&lt;!--   mutate(count_k = str_count(text, "k|K")) --&gt;
&lt;!-- ``` --&gt;

&lt;!-- ```{r} --&gt;
&lt;!-- #| echo: true --&gt;
&lt;!-- #| eval: true --&gt;
&lt;!-- #| fig-cap: "제인 에어 각 장의 처음 10줄에 있는 'K' 또는 'k'의 수" --&gt;
&lt;!-- #| label: fig-janeecountsk --&gt;
&lt;!-- #| message: false --&gt;
&lt;!-- #| warning: false --&gt;

&lt;!-- mean_k &lt;- mean(jane_eyre_reduced$count_k) --&gt;
&lt;!-- variance_k &lt;- var(jane_eyre_reduced$count_k) --&gt;

&lt;!-- jane_eyre_reduced |&gt; --&gt;
&lt;!--   ggplot(aes(y = chapter, x = count_k)) + --&gt;
&lt;!--   geom_point(alpha = 0.5) + --&gt;
&lt;!--   geom_vline(xintercept = mean_k, linetype = "dashed", color = "#C64191") + --&gt;
&lt;!--   geom_vline(xintercept = variance_k, linetype = "dashed", color = "#0ABAB5") + --&gt;
&lt;!--   theme_minimal() + --&gt;
&lt;!--   labs( --&gt;
&lt;!--     x = "처음 10줄의 줄당 k 수", --&gt;
&lt;!--     y = "장" --&gt;
&lt;!--   ) --&gt;
&lt;!-- ``` --&gt;

### 캐나다 앨버타주의 사망률

다소 병적으로 들릴 수 있지만, 매년 각 개인은 사망하거나 사망하지 않습니다.\index{mortality} 지리적 지역의 관점에서, 우리는 매년 사망 원인별 사망자 수에 대한 데이터를 수집할 수 있습니다. 캐나다 앨버타주\index{Canada!Alberta}는 2001년부터 매년 상위 30가지 사망 원인별 사망자 수를 [공개](https://open.alberta.ca/opendata/leading-causes-of-death)했습니다.

항상 그렇듯이 먼저 데이터셋과 모델을 스케치합니다. 데이터셋이 어떻게 생겼을지에 대한 빠른 스케치는 @fig-albertadatasketch이고, 모델에 대한 빠른 스케치는 @fig-albertamodelsketch입니다.

::: {#fig-letterss layout-ncol=2 layout-valign="bottom"}

![앨버타주의 사망 원인을 조사하는 데 사용할 수 있는 데이터셋의 빠른 스케치](figures/IMG_2076.png){#fig-albertadatasketch}

![데이터 또는 분석을 최종화하기 전에 앨버타주의 사망 원인 분석에서 예상하는 것에 대한 빠른 스케치](figures/IMG_2061.png){#fig-albertamodelsketch}

앨버타주의 사망 원인에 대한 예상 데이터셋 및 분석 스케치
:::

음이항 분포를 따르는 사망 원인 데이터셋을 시뮬레이션할 것입니다.\index{simulation}\index{distribution!binomial}

```{
r}
alberta_death_simulation &lt;-
  tibble(
    cause = rep(x = c("심장", "뇌졸중", "당뇨병"), times = 10),
    year = rep(x = 2016:2018, times = 10),
    deaths = rnbinom(n = 30, size = 20, prob = 0.1)
  )

alberta_death_simulation</code></pre>
<p>연도별 및 원인별 사망 분포를 살펴볼 수 있습니다(<a href="#fig-albertacod" class="quarto-xref">그림&nbsp;<span class="quarto-unresolved-ref">fig-albertacod</span></a>). 일부 원인은 상당히 길기 때문에 전체 사망 원인을 잘라냈습니다. 일부 원인은 매년 상위 30위 안에 들지 않으므로 모든 원인이 동일한 발생 횟수를 가지지는 않습니다.</p>
<p>```{ r} #| eval: true #| echo: false</p>
</section>
<section id="년-초에-다운로드된-원본-데이터셋을-참조합니다.-이-장을-업데이트할-때-업데이트된-데이터셋으로-돌아와-업데이트하십시오." class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> 2023년 초에 다운로드된 원본 데이터셋을 참조합니다. 이 장을 업데이트할 때 업데이트된 데이터셋으로 돌아와 업데이트하십시오.</h1>
<p>alberta_cod &lt;- read_csv( “inputs/alberta_COD.csv”, col_types = cols( <code>Calendar Year</code> = col_integer(), Cause = col_character(), Ranking = col_integer(), <code>Total Deaths</code> = col_integer() ) ) |&gt; clean_names() |&gt; add_count(cause) |&gt; mutate(cause = str_trunc(cause, 30))</p>
<pre><code>
2021년 상위 10가지 원인을 살펴보면 다양한 흥미로운 측면을 발견할 수 있습니다(@tbl-albertahuh). 예를 들어, 가장 흔한 원인이 데이터의 21년 전체에 걸쳐 나타날 것으로 예상할 것입니다. 그러나 가장 흔한 원인인 "기타 불분명하고 알 수 없는 사망 원인"은 3년 동안만 나타납니다. "COVID-19, 바이러스 확인"은 캐나다에서 2020년 이전에 알려진 COVID 사망자가 없었기 때문에 다른 2년 동안만 나타납니다.

```{
r}
#| label: tbl-albertahuh
#| tbl-cap: "2021년 앨버타주의 사망 원인 상위 10가지"
#| warning: false

alberta_cod |&gt;
  filter(
    calendar_year == 2021,
    ranking &lt;= 10
  ) |&gt;
  mutate(total_deaths = format(total_deaths, big.mark = ",")) |&gt;
  tt() |&gt; 
  style_tt(j = 1:5, align = "lrrrr") |&gt; 
  format_tt(digits = 0, num_mark_big = ",", num_fmt = "decimal") |&gt; 
  setNames(c("연도", "원인", "순위", "사망자 수", "연수"))</code></pre>
<p>간단하게 하기 위해 2021년 가장 흔한 사망 원인 중 매년 존재했던 5가지 원인으로 제한합니다.</p>
<p>```{ r} alberta_cod_top_five &lt;- alberta_cod |&gt; filter( calendar_year == 2021, n == 21 ) |&gt; slice_max(order_by = desc(ranking), n = 5) |&gt; pull(cause)</p>
<p>alberta_cod &lt;- alberta_cod |&gt; filter(cause %in% alberta_cod_top_five)</p>
<pre><code>

```{
r}
#| fig-cap: "2001년 이후 캐나다 앨버타주의 상위 5가지 사망 원인별 연간 사망자 수"
#| label: fig-albertacod
#| message: false
#| warning: false
#| fig-height: 6

alberta_cod |&gt;
  ggplot(aes(x = calendar_year, y = total_deaths, color = cause)) +
  geom_line() +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  labs(x = "연도", y = "앨버타주의 연간 사망자 수") +
  facet_wrap(vars(cause), dir = "v", ncol = 1) +
  theme(legend.position = "none")</code></pre>
<p>한 가지 주목할 점은 평균 1,273이 분산 182,378과 다르다는 것입니다(<a href="#tbl-ohboyalberta" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-ohboyalberta</span></a>).</p>
<p>```{ r} #| echo: false #| eval: true #| label: tbl-ohboyalberta #| tbl-cap: “캐나다 앨버타주의 연간 사망자 수에 대한 요약 통계, 원인별”</p>
<p>datasummary( total_deaths ~ Min + Mean + Max + SD + Var + N, fmt = 0, data = alberta_cod )</p>
<pre><code>
`stan_glm()`을 사용할 때 "family"에 음이항 분포를 지정하여 음이항 회귀\index{regression!negative binomial}를 구현할 수 있습니다. 이 경우 포아송과 음이항 모두 실행합니다.

```{
r}
#| echo: true
#| eval: false
#| message: false
#| warning: false

cause_of_death_alberta_poisson &lt;-
  stan_glm(
    total_deaths ~ cause,
    data = alberta_cod,
    family = poisson(link = "log"),
    seed = 853
  )

cause_of_death_alberta_neg_binomial &lt;-
  stan_glm(
    total_deaths ~ cause,
    data = alberta_cod,
    family = neg_binomial_2(link = "log"),
    seed = 853
  )</code></pre>
<p>```{ r} #| echo: false #| eval: false</p>
</section>
<section id="internal-5" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> INTERNAL</h1>
<p>saveRDS( cause_of_death_alberta_poisson, file = “outputs/model/cause_of_death_alberta_poisson.rds” )</p>
<p>saveRDS( cause_of_death_alberta_neg_binomial, file = “outputs/model/cause_of_death_alberta_neg_binomial.rds” )</p>
<pre><code>
```{
r}
#| eval: true
#| echo: false

cause_of_death_alberta_poisson &lt;-
  readRDS(file = "outputs/model/cause_of_death_alberta_poisson.rds")

cause_of_death_alberta_neg_binomial &lt;-
  readRDS(file = "outputs/model/cause_of_death_alberta_neg_binomial.rds")</code></pre>
<p>다른 모델을 비교할 수 있습니다(<a href="#tbl-modelsummarypoissonvsnegbinomial" class="quarto-xref">표&nbsp;<span class="quarto-unresolved-ref">tbl-modelsummarypoissonvsnegbinomial</span></a>).</p>
<p>```{ r} #| label: tbl-modelsummarypoissonvsnegbinomial #| tbl-cap: “2001-2020년 앨버타주의 가장 흔한 사망 원인 모델링” #| eval: FALSE</p>
<p>coef_short_names &lt;- c(“causeAll other forms of chronic ischemic heart disease” = “causeAll other forms of…”, “causeMalignant neoplasms of trachea, bronchus and lung” = “causeMalignant neoplas…”, “causeOrganic dementia” = “causeOrganic dementia”, “causeOther chronic obstructive pulmonary disease” = “causeOther chronic obst…” )</p>
<p>modelsummary( list( “포아송” = cause_of_death_alberta_poisson, “음이항” = cause_of_death_alberta_neg_binomial ), coef_map = coef_short_names )</p>
<pre><code>
추정치는 비슷합니다. @sec-inferencewithbayesianmethods에서 소개된 사후 예측 검사\index{Bayesian!posterior predictive check}를 사용하여 음이항 접근 방식이 이 상황에 더 나은 선택임을 보여줄 수 있습니다(@fig-ppcheckpoissonvsbinomial).

```{
r}
#| echo: true
#| eval: true
#| message: false
#| warning: false
#| label: fig-ppcheckpoissonvsbinomial
#| layout-ncol: 2
#| fig-cap: "포아송 및 음이항 모델에 대한 사후 예측 검사 비교"
#| fig-subcap: ["포아송 모델", "음이항 모델"]

pp_check(cause_of_death_alberta_poisson) +
  theme(legend.position = "bottom")

pp_check(cause_of_death_alberta_neg_binomial) +
  theme(legend.position = "bottom")</code></pre>
<p>마지막으로, 리샘플링 방법인 leave-one-out (LOO) 교차 검증(CV)을 사용하여 모델을 비교할 수 있습니다. 이는 교차 검증의 변형으로, 각 폴드의 크기가 1입니다. 즉, 100개의 관측치가 있는 데이터셋이 있다면, 이 LOO는 100겹 교차 검증과 동일합니다. 각 모델에 대해 <code>loo()</code>를 사용하여 <code>rstanarm</code>에서 이를 구현한 다음, <code>loo_compare()</code>를 사용하여 모델을 비교할 수 있습니다. 여기서 값이 높을수록 좋습니다.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>교차 검증에 대한 자세한 정보는 <a href="#sec-predictingpythons" class="quarto-xref">온라인 부록&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-predictingpythons</span></a>에서 제공합니다.</p>
<p>```{ r} #| message: false #| warning: false</p>
<p>poisson &lt;- loo(cause_of_death_alberta_poisson, cores = 2) neg_binomial &lt;- loo(cause_of_death_alberta_neg_binomial, cores = 2)</p>
<p>loo_compare(poisson, neg_binomial)</p>
<pre><code>
이 경우 음이항 모델이 포아송 모델보다 더 잘 적합한다는 것을 알 수 있습니다. ELPD가 더 크기 때문입니다.

## 다단계 모델링

다단계 모델링은 "계층적" 및 "랜덤 효과"를 포함한 다양한 이름으로 불립니다.\index{multilevel modeling!definition}\index{hierarchical modeling|see {multilevel modeling}}\index{random effects|see {multilevel modeling}} 분야마다 의미에 약간의 차이가 있지만, 일반적으로 동일하거나 적어도 유사한 아이디어를 지칭합니다. 다단계 모델링의 근본적인 통찰은 대부분의 경우 우리의 관측치가 서로 완전히 독립적이지 않고, 대신 그룹화될 수 있다는 것입니다. 모델링할 때 그 그룹화를 고려하면 유용한 정보를 얻을 수 있습니다. 예를 들어, 프로 운동선수의 수입은 남성 또는 여성 종목에서 경쟁하는지 여부에 따라 다릅니다. 특정 운동선수의 수입을 그들의 경기 결과를 기반으로 예측하려고 한다면, 개인이 어떤 유형의 종목에서 경쟁했는지 아는 것이 모델이 더 나은 예측을 하는 데 도움이 될 것입니다.

:::{.callout-note}
## 거인의 어깨 위에 서서

피오나 스틸 박사\index{Steele, Fiona}는 런던 경제 대학(LSE)의 통계학 교수입니다.
1996년 사우샘프턴 대학교에서 통계학 박사 학위를 받은 후, LSE에서 강사로 임명되었고, 런던 대학교와 브리스톨 대학교로 옮겨 2008년 정교수로 임명되었습니다. 2013년 LSE로 돌아왔습니다.
그녀의 연구 분야 중 하나는 다단계 모델링과 인구 통계학, 교육, 가족 심리학 및 건강 분야의 응용입니다. 예를 들어, @Steele2007은 종단 데이터에 대한 다단계 모델을 살펴보고, @Steele2007again은 다단계 모델을 사용하여 학교 자원과 학생 성취도 간의 관계를 살펴봅니다.
그녀는 2008년 왕립 통계 학회 가이 메달\index{Guy Medal!Bronze} 동상을 수상했습니다.
:::

우리는 세 가지 설정을 구별합니다.\index{multilevel modeling!pooling}

1) 완전 풀링: 모든 관측치를 동일한 그룹에서 온 것으로 처리합니다. 이는 지금까지 우리가 해왔던 방식입니다.
2) 풀링 없음: 모든 그룹을 별도로 처리합니다. 이는 각 그룹에 대해 별도의 회귀를 실행하는 경우 발생할 수 있습니다.
3) 부분 풀링: 그룹 구성원이 어떤 영향을 미치도록 허용합니다.

예를 들어, 전 세계 각국의 GDP와 인플레이션 간의 관계에 관심이 있다고 가정해 봅시다. 완전 풀링은 모든 국가를 하나의 그룹에 넣을 것이고, 풀링 없음은 각 대륙에 대해 별도의 회귀를 실행할 것입니다. 이제 부분 풀링 접근 방식을 설명할 것입니다.

일반적으로 이를 수행하는 두 가지 방법이 있습니다.

1) 다양한 절편을 활성화하거나,
2) 다양한 기울기를 활성화합니다.

이 책에서는 첫 번째만 고려하지만, @gelmanhillvehtari2020, @citemcelreath, @bayesrules로 넘어가야 합니다.

### 시뮬레이션 예시: 정치적 지지

개인의 성별과 거주하는 주에 따라 특정 정당에 대한 지지 확률이 달라지는 상황을 고려해 봅시다.

$$
\begin{aligned}
y_i|\pi_i &amp; \sim \mbox{Bern}(\pi_i) \\
\mbox{logit}(\pi_i) &amp; = \beta_0 + \alpha_{g[i]}^{\mbox{gender}} + \alpha_{s[i]}^{\mbox{state}} \\
\beta_0 &amp; \sim \mbox{Normal}(0, 2.5)\\
\alpha_{g}^{\mbox{gender}} &amp; \sim \mbox{Normal}(0, 2.5)\mbox{ for }g=1, 2\\
\alpha_{s}^{\mbox{state}} &amp; \sim \mbox{Normal}\left(0, \sigma_{\mbox{state}}^2\right)\mbox{ for }s=1, 2, \dots, S\\
\sigma_{\mbox{state}} &amp; \sim \mbox{Exponential}(1)
\end{aligned}
$$

여기서 $\pi_i = \mbox{Pr}(y_i=1)$이고, 두 가지 성별 그룹이 있습니다. 왜냐하면 @sec-multilevel-regression-with-post-stratification에서 사용할 설문 조사에서 사용할 수 있는 것이 그것이기 때문입니다. 그리고 $S$는 총 주 수입니다. `rstanarm`의 `stan_glmer()` 내에서 "(1 | state)"를 사용하여 함수에 이를 포함합니다[@citerstanarm]. 이 용어는 주별 그룹 효과를 보고 있음을 나타내며, 이는 적합된 모델의 절편이 주에 따라 달라질 수 있음을 의미합니다.\index{distribution!Normal}

```{
r}
#| warning: false
#| message: false

set.seed(853)

political_support &lt;-
  tibble(
    state = sample(1:50, size = 1000, replace = TRUE),
    gender = sample(c(1, 2), size = 1000, replace = TRUE),
    noise = rnorm(n = 1000, mean = 0, sd = 10) |&gt; round(),
    supports = if_else(state + gender + noise &gt; 50, 1, 0)
  )

political_support</code></pre>
<p>```{ r} #| eval: false #| echo: true #| message: false #| warning: false</p>
<p>voter_preferences &lt;- stan_glmer( supports ~ gender + (1 | state), data = political_support, family = binomial(link = “logit”), prior = normal(location = 0, scale = 2.5, autoscale = TRUE), prior_intercept = normal(location = 0, scale = 2.5, autoscale = TRUE), seed = 853 )</p>
<p>saveRDS( voter_preferences, file = “voter_preferences.rds” )</p>
<pre><code>
```{
r}
#| eval: false
#| include: false
#| message: false
#| warning: false

# INTERNAL
saveRDS(
  voter_preferences,
  file = "outputs/model/voter_preferences.rds"
)</code></pre>
<p>```{ r} #| eval: true #| echo: false #| message: false #| warning: false</p>
<p>voter_preferences &lt;- readRDS(file = “outputs/model/voter_preferences.rds”)</p>
<pre><code>
```{
r}
voter_preferences</code></pre>
<p>새로운 모델링 상황에 직면했을 때, 특히 추론이 주요 관심사인 경우 다단계 모델을 사용할 기회를 찾는 것이 좋습니다. 모델에 더 많은 정보를 제공하기 위해 활용할 수 있는 어떤 그룹화가 종종 있습니다.</p>
<p>다단계 모델링으로 전환할 때, 일부 <code>rstanarm</code> 모델에서 “발산 전환”에 대한 경고가 발생할 수 있습니다. 이 책에서 모델을 작동시키는 목적을 위해, 경고가 소수이고 계수의 Rhat 값이 모두 1에 가까우면(<code>any(summary(change_this_to_the_model_name)[, "Rhat"] &gt; 1.1)</code>로 확인) 무시하십시오. 경고가 소수 이상이거나 Rhat 중 하나라도 1에 가깝지 않다면, <code>stan_glmer()</code>에 “adapt_delta = 0.99”를 인수로 추가하고 모델을 다시 실행하십시오(실행 시간이 더 오래 걸린다는 점을 염두에 두십시오). 이것으로 문제가 해결되지 않으면 변수를 제거하여 모델을 단순화하십시오. <a href="#sec-multilevel-regression-with-post-stratification에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-multilevel-regression-with-post-stratification에서</span></a> MRP를 2020년 미국 선거에 적용할 때 “adapt_delta” 전략이 문제를 해결하는 예시를 볼 것입니다.</p>
<section id="오스틴-브론테-디킨스-셰익스피어" class="level3" data-number="20.0.1">
<h3 data-number="20.0.1" class="anchored" data-anchor-id="오스틴-브론테-디킨스-셰익스피어"><span class="header-section-number">20.0.1</span> 오스틴, 브론테, 디킨스, 셰익스피어</h3>
<p>다단계 모델링의 예시로, 프로젝트 구텐베르크의 제인 오스틴, 샬럿 브론테, 찰스 디킨스, 윌리엄 셰익스피어 네 작가의 책 길이에 대한 데이터를 고려합니다. 오스틴, 브론테, 디킨스는 책을 썼으므로 셰익스피어(희곡을 썼으므로)보다 더 긴 책을 썼을 것으로 예상합니다. 그러나 세 책 작가 간에 어떤 차이를 예상해야 할지는 명확하지 않습니다.</p>
<p>```{ r} #| eval: false #| echo: true authors &lt;- c(“오스틴, 제인”, “디킨스, 찰스”, “셰익스피어, 윌리엄”, “브론테, 샬럿”)</p>
</section>
</section>
<section id="중복-및-원치-않는-문자에-대한-문서-값" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> 중복 및 원치 않는 문자에 대한 문서 값</h1>
<p>dont_get_shakespeare &lt;- c(2270, 4774, 5137, 9077, 10606, 12578, 22791, 23041, 23042, 23043, 23044, 23045, 23046, 28334, 45128, 47518, 47715, 47960, 49007, 49008, 49297, 50095, 50559) dont_get_bronte &lt;- c(31100, 42078) dont_get_dickens &lt;- c(25852, 25853, 25854, 30368, 32241, 35536, 37121, 40723, 42232, 43111, 43207, 46675, 47529, 47530, 47531, 47534, 47535, 49927, 50334)</p>
<p>books &lt;- gutenberg_works( author %in% authors, !gutenberg_id %in% c(dont_get_shakespeare, dont_get_bronte, dont_get_dickens) ) |&gt; gutenberg_download( meta_fields = c(“title”, “author”), mirror = “https://gutenberg.pglaf.org/” )</p>
<p>write_csv(books, “books-austen_bronte_dickens_shakespeare.csv”)</p>
<pre><code>
```{
r}
#| eval: false
#| echo: false

# INTERNAL

write_csv(books, "dont_push/books-austen_bronte_dickens_shakespeare.csv")</code></pre>
<p>```{ r} #| eval: false #| echo: false</p>
</section>
<section id="internal-6" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> INTERNAL</h1>
<p>books &lt;- read_csv( “dont_push/books-austen_bronte_dickens_shakespeare.csv”, col_types = cols( gutenberg_id = col_integer(), text = col_character(), title = col_character(), author = col_character() ) )</p>
<pre><code>
```{
r}
#| eval: false
#| echo: true

books &lt;- read_csv(
  "books-austen_bronte_dickens_shakespeare.csv",
  col_types = cols(
    gutenberg_id = col_integer(),
    text = col_character(),
    title = col_character(),
    author = col_character()
  )
)</code></pre>
<p>```{ r} #| eval: false #| echo: true</p>
<p>lines_by_author_work &lt;- books |&gt; summarise(number_of_lines = n(), .by = c(author, title))</p>
<p>lines_by_author_work</p>
<pre><code>
```{
r}
#| eval: false
#| echo: false

# INTERNAL

write_csv(lines_by_author_work, "outputs/lines_by_author_work.csv")</code></pre>
<p>```{ r} #| eval: true #| echo: false</p>
<p>lines_by_author_work &lt;- read_csv( “outputs/lines_by_author_work.csv”, col_types = cols( author = col_character(), title = col_character(), number_of_lines = col_integer() ) )</p>
<p>lines_by_author_work</p>
<pre><code>

```{
r}
#| echo: true
#| eval: false

author_lines_rstanarm &lt;-
  stan_glm(
    number_of_lines ~ author,
    data = lines_by_author_work,
    family = neg_binomial_2(link = "log"),
    prior = normal(location = 0, scale = 3, autoscale = TRUE),
    prior_intercept = normal(location = 0, scale = 3, autoscale = TRUE),
    seed = 853
  )

saveRDS(
  author_lines_rstanarm,
  file = "author_lines_rstanarm.rds"
)

author_lines_rstanarm_multilevel &lt;-
  stan_glmer(
    number_of_lines ~ (1 | author),
    data = lines_by_author_work,
    family = neg_binomial_2(link = "log"),
    prior = normal(location = 0, scale = 3, autoscale = TRUE),
    prior_intercept = normal(location = 0, scale = 3, autoscale = TRUE),
    seed = 853
  )

saveRDS(
  author_lines_rstanarm_multilevel,
  file = "author_lines_rstanarm_multilevel.rds"
)</code></pre>
<p>```{ r} #| echo: false #| eval: false #| message: false #| warning: false</p>
</section>
<section id="internal-7" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> INTERNAL</h1>
<p>saveRDS( author_lines_rstanarm, file = “outputs/model/author_lines_rstanarm.rds” )</p>
<p>saveRDS( author_lines_rstanarm_multilevel, file = “outputs/model/author_lines_rstanarm_multilevel.rds” )</p>
<pre><code>
```{
r}
#| eval: true
#| echo: false
#| warning: false
#| message: false

author_lines_rstanarm &lt;-
  readRDS(file = "outputs/model/author_lines_rstanarm.rds")

author_lines_rstanarm_multilevel &lt;-
  readRDS(file = "outputs/model/author_lines_rstanarm_multilevel.rds")</code></pre>
<p>```{ r} #| label: tbl-modelsummaryaustenshakes #| tbl-cap: “오스틴, 브론테, 디킨스, 셰익스피어가 줄 수를 기반으로 책을 썼는지 설명” #| warning: false #| eval: false</p>
<p>modelsummary( list( “음이항” = author_lines_rstanarm, “다단계 음이항” = author_lines_rstanarm_multilevel ) )</p>
<pre><code>
@tbl-modelsummaryaustenshakes는 다단계 모델의 경우 약간 비어 있으며, 독자에게 숫자로 압도하는 것을 피하기 위해 종종 그래프를 사용합니다(@sec-multilevel-regression-with-post-stratification에서 이에 대한 예시를 볼 것입니다). 예를 들어, @fig-multilevelexampleleveldistribution은 `tidybayes`의 `spread_draws()`를 사용하여 네 작가 각각에 대한 표본 분포를 보여줍니다.

```{
r}
#| echo: true
#| eval: true
#| message: false
#| warning: false
#| label: tbl-multilevelexampleleveldistribution
#| fig-cap: "네 작가 각각에 대한 표본 분포 검토"

author_lines_rstanarm_multilevel |&gt;
  spread_draws(`(Intercept)`, b[, group]) |&gt;
  mutate(condition_mean = `(Intercept)` + b) |&gt;
  ggplot(aes(y = group, x = condition_mean)) +
  stat_halfeye() +
  theme_minimal()</code></pre>
<p>이 경우, 우리는 브론테가 세 책 작가 중 가장 긴 책을 쓸 것으로 예상합니다. 셰익스피어는 예상대로 가장 적은 줄을 가진 작품을 썼습니다.</p>
<section id="결론" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="결론"><span class="header-section-number">23.1</span> 결론</h2>
<p>이 장에서는 일반화 선형 모델을 고려하고 다단계 모델링을 소개했습니다. <a href="#sec-its-just-a-linear-model에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-linear-model에서</span></a> 확립된 기초를 바탕으로 베이즈 모델 구축에 필요한 몇 가지 필수 사항을 제공했습니다. <a href="#sec-its-just-a-linear-model에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-linear-model에서</span></a> 언급했듯이, 이것은 시작하기에 충분합니다. 더 많은 것을 배우고 싶으시다면 <a href="#sec-concluding-remarks에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-concluding-remarks에서</span></a> 권장하는 모델링 책부터 시작해야 합니다.</p>
<p><a href="#sec-its-just-a-linear-model와" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-linear-model와</span></a> <a href="#sec-its-just-a-generalized-linear-model를" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-generalized-linear-model를</span></a> 통해 다양한 베이즈 모델 접근 방식을 다루었습니다. 그러나 모든 모델에 대해 모든 것을 다루지는 않았습니다.</p>
<p>“충분하다”는 것이 무엇인지 명확하게 정의하기는 어렵습니다. 왜냐하면 맥락에 따라 다르기 때문입니다. 그러나 <a href="#sec-its-just-a-linear-model와" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-linear-model와</span></a> <a href="#sec-its-just-a-generalized-linear-model에서" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-generalized-linear-model에서</span></a> 소개된 개념을 바탕으로 한 다음 체크리스트는 시작하는 데 대부분의 목적에 충분할 것입니다. 논문의 모델 섹션에서 방정식을 사용하여 모델을 작성하고, 방정식을 설명하는 몇 단락의 텍스트를 포함하십시오. 그런 다음 모델 선택을 정당화하고, 고려했던 대안을 간략하게 설명하십시오. 마지막으로 모델이 어떻게 적합되었는지 설명하는 문장을 포함하십시오. 이 경우 <code>rstanarm</code>으로 적합되었을 가능성이 높으며, 진단은 교차 참조된 부록에서 확인할 수 있습니다. 해당 부록에는 사전 예측 검사, 트레이스 플롯, Rhat 플롯, 사후 분포 및 사후 예측 검사가 포함되어야 합니다.</p>
<p>결과 섹션에는 <code>modelsummary</code>를 사용하여 구축된 추정치 표를 포함하고, <code>marginaleffects</code>의 도움을 받아 설명하십시오. 특히 다단계 모델을 사용하는 경우 <code>tidybayes</code>의 도움을 받아 결과 그래프를 포함하는 것도 유용할 수 있습니다. 모델 자체는 별도의 R 스크립트에서 실행되어야 합니다. 클래스 및 관측치 수에 대한 테스트가 선행되어야 합니다. 계수에 대한 테스트가 뒤따라야 합니다. 이들은 시뮬레이션을 기반으로 해야 합니다. 해당 R 스크립트에서 <code>saveRDS()</code>를 사용하여 모델을 저장해야 합니다. Quarto 문서에서는 <code>readRDS()</code>를 사용하여 해당 모델을 읽어들여야 합니다.</p>
</section>
<section id="연습-문제" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="연습-문제"><span class="header-section-number">23.2</span> 연습 문제</h2>
<section id="연습" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="연습">연습</h3>
<ol type="1">
<li><em>(계획)</em> 다음 시나리오를 고려하십시오: <em>어떤 사람이 호주 시드니에서 암으로 인한 사망자 수에 관심이 있습니다. 그들은 지난 20년 동안 가장 큰 5개 병원에서 데이터를 수집합니다.</em> 데이터셋이 어떻게 생겼을지 스케치한 다음, 모든 관측치를 보여주기 위해 만들 수 있는 그래프를 스케치하십시오.</li>
<li><em>(시뮬레이션)</em> 설명된 시나리오를 더 고려하고 상황을 시뮬레이션하십시오. 결과(원인별 사망자 수)와 몇 가지 예측 변수를 모두 포함하십시오. 시뮬레이션된 데이터를 기반으로 최소 10개의 테스트를 포함하십시오.</li>
<li><em>(수집)</em> 그러한 데이터셋의 가능한 출처를 설명하십시오.</li>
<li><em>(탐색)</em> <code>ggplot2</code>를 사용하여 스케치한 그래프를 만드십시오. 그런 다음 <code>rstanarm</code>을 사용하여 모델을 구축하십시오.</li>
<li><em>(소통)</em> 자신이 한 일에 대해 두 단락을 작성하십시오.</li>
</ol>
</section>
<section id="퀴즈" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="퀴즈">퀴즈</h3>
<ol type="1">
<li>로지스틱 회귀를 언제 고려해야 합니까 (하나 선택)?
<ol type="a">
<li>연속 결과 변수.</li>
<li>이진 결과 변수.</li>
<li>개수 결과 변수.</li>
</ol></li>
<li>2020년 미국 대통령 선거에서 투표 의향이 개인의 소득에 따라 어떻게 달라지는지 연구하는 데 관심이 있습니다. 이 관계를 연구하기 위해 로지스틱 회귀 모델을 설정합니다. 이 연구에서 가능한 결과 변수 중 하나는 (하나 선택)?
<ol type="a">
<li>응답자가 미국 시민인지 여부 (예/아니오)</li>
<li>응답자의 개인 소득 (높음/낮음)</li>
<li>응답자가 바이든에게 투표할 것인지 여부 (예/아니오)</li>
<li>응답자가 2016년에 누구에게 투표했는지 (트럼프/클린턴)</li>
</ol></li>
<li>2020년 미국 대통령 선거에서 투표 의향이 개인의 소득에 따라 어떻게 달라지는지 연구하는 데 관심이 있습니다. 이 관계를 연구하기 위해 로지스틱 회귀 모델을 설정합니다. 이 연구에서 가능한 예측 변수는 (모두 선택하십시오)?
<ol type="a">
<li>응답자의 인종 (백인/비백인)</li>
<li>응답자의 혼인 상태 (기혼/미혼)</li>
<li>응답자가 바이든에게 투표할 것인지 여부 (예/아니오)</li>
</ol></li>
<li>포아송 분포의 평균은 무엇과 같습니까?
<ol type="a">
<li>중앙값.</li>
<li>표준 편차.</li>
<li>분산.</li>
</ol></li>
<li>미국 선거의 <code>rstanarm</code> 예시를 다시 수행하되, 추가 변수를 포함하십시오. 어떤 변수를 선택했으며, 모델의 성능은 어떻게 향상되었습니까?</li>
<li><span class="math inline">\(\lambda = 75\)</span>일 때 포아송 분포의 밀도 그래프를 만드십시오.</li>
<li><span class="citation" data-cites="gelmanhillvehtari2020에">(<a href="#ref-gelmanhillvehtari2020에" role="doc-biblioref"><strong>gelmanhillvehtari2020에?</strong></a>)</span> 따르면, 포아송 회귀에서 오프셋은 무엇입니까?</li>
<li><em>제인 에어</em> 예시를 다시 수행하되, “A/a”에 대해 수행하십시오.</li>
<li>20세기 영국 통계학자 조지 박스는 유명하게 “모든 모델은 틀렸으므로 과학자는 중요하게 틀린 것에 주의해야 한다. 호랑이가 돌아다니는데 쥐에 대해 걱정하는 것은 부적절하다.”라고 말했습니다<span class="citation" data-cites="Box1976">(<a href="#ref-Box1976" role="doc-biblioref">Box 1976</a>, p.&nbsp;792)</span>. 예시와 인용을 통해 논의하십시오.</li>
</ol>
</section>
<section id="수업-활동" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="수업-활동">수업 활동</h3>
<ul>
<li>축구 또는 하키 중 무엇을 선호하는지, 그리고 연령, 성별, 위치와 어떤 관련이 있는지 조사하기 위한 베이즈 회귀 모델을 어떻게 구축할 것인지 논의하십시오. 다음을 작성하십시오.
<ul>
<li>관심 결과 및 가능성</li>
<li>관심 결과에 대한 회귀 모델</li>
<li>모델에서 추정할 매개변수에 대한 사전 분포.</li>
</ul></li>
<li><a href="#sec-its-just-a-linear-model에서와" class="quarto-xref"><span class="quarto-unresolved-ref">sec-its-just-a-linear-model에서와</span></a> 마찬가지로, <code>palmerpenguins</code>를 사용하여 부리 길이와 깊이 사이의 관계를 이해하는 데 다시 관심이 있지만, 이번에는 세 종 모두에 대해 관심이 있습니다. 각 종에 대해 별도의 모델을 추정하는 것으로 시작하십시오. 그런 다음 세 종 모두에 대해 하나의 모델을 추정하십시오. 마지막으로, 부분 풀링을 사용하는 모델을 추정하십시오.</li>
<li><a href="https://github.com/RohanAlexander/starter_folder">시작 폴더</a>를 사용하고 새 리포지토리를 만드십시오. 수업의 공유 Google 문서에 GitHub 리포지토리 링크를 추가하십시오.
<ul>
<li>교육, 연령대, 성별 및 주를 기반으로 민주당 또는 공화당 지지를 설명하는 데 관심이 있습니다. 상황을 스케치하고 시뮬레이션하십시오.</li>
<li><span class="citation" data-cites="cohn2016의">(<a href="#ref-cohn2016의" role="doc-biblioref"><strong>cohn2016의?</strong></a>)</span> 기반 데이터를 <a href="https://github.com/TheUpshot/2016-upshot-siena-polls/">여기</a>에서 얻으십시오. 편집되지 않은 데이터를 저장하고, 분석 데이터셋을 구성하십시오(시작하는 데 도움이 되는 일부 코드가 아래에 있습니다). 각 변수의 그래프를 개별적으로 데이터 섹션에 추가하고, 그들이 어떻게 관련되는지에 대한 그래프도 추가하십시오.</li>
<li>“vt_pres_2”를 “gender”, “educ”, “age”의 함수로 설명하는 모델을 하나 구축하고, 추가로 “state”를 고려하는 모델을 하나 더 구축하십시오. 두 모델을 모델 섹션에 작성하고, 결과를 결과 섹션에 추가하십시오(다시, 시작하는 데 도움이 되는 일부 코드가 아래에 있습니다). ```{ r} #| echo: true #| eval: false</li>
</ul></li>
</ul>
<p>vote_data &lt;- read_csv( “https://raw.githubusercontent.com/TheUpshot/2016-upshot-siena-polls/master/upshot-siena-polls.csv” )</p>
<p>cleaned_vote_data &lt;- vote_data |&gt; select(vt_pres_2, gender, educ, age, state) |&gt; rename(vote = vt_pres_2) |&gt; mutate( gender = factor(gender), educ = factor(educ), state = factor(state), age = as.integer(age) ) |&gt; mutate( vote = case_when( vote == “Donald Trump, the Republican” ~ “0”, vote == “Hillary Clinton, the Democrat” ~ “1”, TRUE ~ vote ) ) |&gt; filter(vote %in% c(“0”, “1”)) |&gt; mutate(vote = as.integer(vote))</p>
<pre><code>
```{
r}
#| echo: true
#| eval: false

vote_model &lt;-
  stan_glm(
    formula = vote ~ age + educ,
    data = cleaned_vote_data,
    family = gaussian(),
    prior = normal(location = 0, scale = 2.5),
    prior_intercept = normal(location = 0, scale = 2.5),
    prior_aux = exponential(rate = 1),
    seed = 853
  )</code></pre>
</section>
<section id="과제" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="과제">과제</h3>
<p><span class="citation" data-cites="maher1982modelling">Maher (<a href="#ref-maher1982modelling" role="doc-biblioref">1982</a>)</span>, <span class="citation" data-cites="thanksleo">Smith (<a href="#ref-thanksleo" role="doc-biblioref">2002</a>)</span>, 또는 <span class="citation" data-cites="cohn2016을">(<a href="#ref-cohn2016을" role="doc-biblioref"><strong>cohn2016을?</strong></a>)</span> 고려하십시오. 그들의 모델의 단순화된 버전을 구축하십시오.</p>
<p>최근 관련 데이터를 얻고, 모델을 추정하고, 로지스틱, 포아송, 음이항 회귀 중 선택에 대해 논의하십시오.</p>
<p>Quarto를 사용하고, 적절한 제목, 저자, 날짜, GitHub 리포지토리 링크, 섹션 및 인용을 포함하고, 모델을 철저히 지정하십시오.</p>
</section>
<section id="논문" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="논문">논문</h3>
<p>이 시점에서 <a href="#sec-papers" class="quarto-xref">온라인 부록&nbsp;<span class="quarto-unresolved-ref ref-noprefix">sec-papers</span></a>의 <em>Spadina</em> 논문이 적절할 것입니다.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-guidetothe2020ces" class="csl-entry" role="listitem">
Ansolabehere, Stephen, Brian Schaffner, 와/과 Sam Luks. 2021. <span>“<span>Guide to the 2020 Cooperative Election Study</span>”</span>. <a href="https://doi.org/10.7910/DVN/E9N6PH">https://doi.org/10.7910/DVN/E9N6PH</a>.
</div>
<div id="ref-citemodelsummary" class="csl-entry" role="listitem">
Arel-Bundock, Vincent. 2022. <span>“<span>modelsummary</span>: Data and Model Summaries in <span>R</span>”</span>. <em>Journal of Statistical Software</em> 103 (1): 1–23. <a href="https://doi.org/10.18637/jss.v103.i01">https://doi.org/10.18637/jss.v103.i01</a>.
</div>
<div id="ref-marginaleffects" class="csl-entry" role="listitem">
———. 2023. <em><span>marginaleffects: Predictions, Comparisons, Slopes, Marginal Means, and Hypothesis Tests</span></em>. <a href="https://vincentarelbundock.github.io/marginaleffects/">https://vincentarelbundock.github.io/marginaleffects/</a>.
</div>
<div id="ref-tinytable" class="csl-entry" role="listitem">
———. 2024. <em><span>tinytable: Simple and Configurable Tables in <span>“HTML”</span>, <span>“LaTeX”</span>, <span>“Markdown”</span>, <span>“Word”</span>, <span>“PNG”</span>, <span>“PDF”</span>, and <span>“Typst”</span> Formats</span></em>. <a href="https://vincentarelbundock.github.io/tinytable/">https://vincentarelbundock.github.io/tinytable/</a>.
</div>
<div id="ref-mixedbroom" class="csl-entry" role="listitem">
Bolker, Ben, 와/과 David Robinson. 2022. <em><span>broom.mixed: Tidying Methods for Mixed Models</span></em>. <a href="https://CRAN.R-project.org/package=broom.mixed">https://CRAN.R-project.org/package=broom.mixed</a>.
</div>
<div id="ref-Box1976" class="csl-entry" role="listitem">
Box, George E. P. 1976. <span>“Science and Statistics”</span>. <em>Journal of the American Statistical Association</em> 71 (356): 791–99. <a href="https://doi.org/10.1080/01621459.1976.10480949">https://doi.org/10.1080/01621459.1976.10480949</a>.
</div>
<div id="ref-boot" class="csl-entry" role="listitem">
Canty, Angelo, 와/과 B. D. Ripley. 2021. <em><span>boot: Bootstrap R (S-Plus) Functions</span></em>.
</div>
<div id="ref-cohn2016" class="csl-entry" role="listitem">
Cohn, Nate. 2016. <span>“We Gave Four Good Pollsters the Same Raw Data. They Had Four Different Results”</span>. <em>The New York Times</em>, 9월. <a href="https://www.nytimes.com/interactive/2016/09/20/upshot/the-error-the-polling-world-rarely-talks-about.html">https://www.nytimes.com/interactive/2016/09/20/upshot/the-error-the-polling-world-rarely-talks-about.html</a>.
</div>
<div id="ref-bootii" class="csl-entry" role="listitem">
Davison, A. C., 와/과 D. V. Hinkley. 1997. <em>Bootstrap Methods and Their Applications</em>. Cambridge: Cambridge University Press. <a href="http://statwww.epfl.ch/davison/BMA/">http://statwww.epfl.ch/davison/BMA/</a>.
</div>
<div id="ref-janitor" class="csl-entry" role="listitem">
Firke, Sam. 2023. <em><span>janitor: Simple Tools for Examining and Cleaning Dirty Data</span></em>. <a href="https://CRAN.R-project.org/package=janitor">https://CRAN.R-project.org/package=janitor</a>.
</div>
<div id="ref-HistData" class="csl-entry" role="listitem">
Friendly, Michael. 2021. <em>HistData: Data Sets from the History of Statistics and Data Visualization</em>. <a href="https://CRAN.R-project.org/package=HistData">https://CRAN.R-project.org/package=HistData</a>.
</div>
<div id="ref-gelmanhillvehtari2020" class="csl-entry" role="listitem">
Gelman, Andrew, Jennifer Hill, 와/과 Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press. <a href="https://avehtari.github.io/ROS-Examples/">https://avehtari.github.io/ROS-Examples/</a>.
</div>
<div id="ref-citerstanarm" class="csl-entry" role="listitem">
Goodrich, Ben, Jonah Gabry, Imad Ali, 와/과 Sam Brilleman. 2023. <span>“<span>rstanarm: <span>Bayesian</span> applied regression modeling via <span>Stan</span></span>”</span>. <a href="https://mc-stan.org/rstanarm">https://mc-stan.org/rstanarm</a>.
</div>
<div id="ref-islr" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, 와/과 Robert Tibshirani. (2013년) 2021. <em><span>An Introduction to Statistical Learning with Applications in R</span></em>. 2nd ed. Springer. <a href="https://www.statlearning.com">https://www.statlearning.com</a>.
</div>
<div id="ref-gutenbergr" class="csl-entry" role="listitem">
Johnston, Myfanwy, 와/과 David Robinson. 2022. <em><span>gutenbergr: Download and Process Public Domain Works from Project Gutenberg</span></em>. <a href="https://CRAN.R-project.org/package=gutenbergr">https://CRAN.R-project.org/package=gutenbergr</a>.
</div>
<div id="ref-citetidybayes" class="csl-entry" role="listitem">
Kay, Matthew. 2022. <em><span>tidybayes</span>: Tidy Data and Geoms for <span>Bayesian</span> Models</em>. <a href="https://doi.org/10.5281/zenodo.1308151">https://doi.org/10.5281/zenodo.1308151</a>.
</div>
<div id="ref-collapse" class="csl-entry" role="listitem">
Krantz, Sebastian. 2023. <em><span>collapse: Advanced and Fast Data Transformation</span></em>. <a href="https://CRAN.R-project.org/package=collapse">https://CRAN.R-project.org/package=collapse</a>.
</div>
<div id="ref-dataverse" class="csl-entry" role="listitem">
Kuriwaki, Shiro, Will Beasley, 와/과 Thomas Leeper. 2023. <em><span>dataverse: R Client for Dataverse 4+ Repositories</span></em>.
</div>
<div id="ref-maher1982modelling" class="csl-entry" role="listitem">
Maher, Michael. 1982. <span>“Modelling association football scores”</span>. <em>Statistica Neerlandica</em> 36 (3): 109–18. <a href="https://doi.org/10.1111/j.1467-9574.1982.tb00782.x">https://doi.org/10.1111/j.1467-9574.1982.tb00782.x</a>.
</div>
<div id="ref-pitman" class="csl-entry" role="listitem">
Pitman, Jim. 1993. <em>Probability</em>. 1st ed. New York: Springer. <a href="https://doi.org/10.1007/978-1-4612-4374-8">https://doi.org/10.1007/978-1-4612-4374-8</a>.
</div>
<div id="ref-citeR" class="csl-entry" role="listitem">
R Core Team. 2024. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-cooperativeelectionstudyus" class="csl-entry" role="listitem">
Schaffner, Brian, Stephen Ansolabehere, 와/과 Sam Luks. 2021. <span>“<span>Cooperative Election Study Common Content, 2020</span>”</span>. Harvard Dataverse. <a href="https://doi.org/10.7910/DVN/E9N6PH">https://doi.org/10.7910/DVN/E9N6PH</a>.
</div>
<div id="ref-thanksleo" class="csl-entry" role="listitem">
Smith, Richard. 2002. <span>“A statistical assessment of Buchanan’s vote in Palm Beach County”</span>. <em>Statistical Science</em> 17 (4): 441–57. <a href="https://doi.org/10.1214/ss/1049993203">https://doi.org/10.1214/ss/1049993203</a>.
</div>
<div id="ref-Stigler1978" class="csl-entry" role="listitem">
Stigler, Stephen. 1978. <span>“<span>Francis Ysidro Edgeworth, Statistician</span>”</span>. <em>Journal of the Royal Statistical Society. Series A (General)</em> 141 (3): 287–322. <a href="https://doi.org/10.2307/2344804">https://doi.org/10.2307/2344804</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jenny Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, 기타. 2019. <span>“<span>Welcome to the Tidyverse</span>”</span>. <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>
</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>배경 지식으로, LOO-CV는 <code>loo()</code>에 의해 수행되지 않습니다. 왜냐하면 계산적으로 너무 집약적이기 때문입니다. 대신 근사치가 수행되어 예상 로그 포인트별 예측 밀도(ELPD)를 제공합니다. <code>rstanarm</code> 비네트는 더 자세한 정보를 제공합니다.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "복사완료!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "복사완료!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/tellingstorieswithdata\.com\/mybook");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12-ijalm_ko.html" class="pagination-link" aria-label="선형 모델">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 모델</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./13-prediction_ko.html" class="pagination-link" aria-label="예측">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">예측</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/RohanAlexander/telling_stories/edit/main/13-ijaglm_ko.qmd" class="toc-action"><i class="bi bi-github"></i>편집</a></li></ul></div></div></div></footer></body></html>